<NameSpace
 Width="100"
 Height="50"
 Name="PositionReport"
 Guid="e7cf5843-ef46-4028-aa51-d0dc661e9005"
>
<NameSpaces>
</NameSpaces>
<Enumerations>
<Enum
 Default="PositionReportSpecialLocation.DoNotSend"
 Implemented="TRUE"
 Name="PositionReportSpecialLocation"
 Guid="476931ac-c736-436a-8d31-ea5db2a0e915"
>
<ReqRef
 Id="5bc210dc-ac9e-4d2a-9508-b89f3d465a7b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3f10dc5c-11cc-4201-9a25-fcd767995693"
>
</ReqRef><ReqRef
 Id="3c43c95f-9a2d-4244-a81b-8ce6833a6a96"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="896b214f-b7b7-4551-8506-d99d27e5803e"
>
</ReqRef><ReqRef
 Id="aa035c94-e9a5-4a0d-80ed-80d1a0e9db3f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bc54cffd-8d18-4ef3-aa0b-3490e16c3d7d"
>
</ReqRef><ReqRef
 Id="83966f12-95e0-4bd1-a94c-f51c035af1c1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="593d4130-2967-47da-b2a0-de195360ab2d"
>
</ReqRef><Comment>The possible values of position report special locations.</Comment>
<Values>
<EnumValue
 Value="0"
 Name="DoNotSend"
 Guid="d2f064a4-349a-4448-bec2-0050eb993e54"
>
</EnumValue><EnumValue
 Value="1"
 Name="Now"
 Guid="fc6d298a-c88b-4d8d-a832-322076f6b464"
>
</EnumValue><EnumValue
 Value="2"
 Name="LRBG"
 Guid="b553051e-abc4-4950-938d-c4edcbc815a6"
>
</EnumValue></Values>
</Enum></Enumerations>
<Structures>
<Structure
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="PositionReportEventsTracker"
 Guid="e4d7d885-b4b0-4a2f-84fe-fd83278d8dac"
>
<Comment>Keeps the information that can provode the sending of a new position report.</Comment>
<StructureElement
 TypeName="Messages.Q_LENGTH"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="TrainIntegrityStatus"
 Guid="702a47f2-b548-4920-90c2-c9af032dad2d"
>
<ReqRef
 Id="08ae9142-b051-4a16-ad2f-f7e7d927a51e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="dd3f42b9-d613-4ae9-b122-4c3e5679fdbb"
>
</ReqRef><ReqRef
 Id="5e354f4a-2bd0-458a-983a-75be865356d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="597cf4ba-39be-4e74-b946-c07ad32f1204"
>
</ReqRef><Comment>Contains the previous value of the train integrity status in order to know if that value has changed.</Comment>
</StructureElement><StructureElement
 TypeName="Default.BaseTypes.Speed"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Speed"
 Guid="cd628589-9d93-4fae-9f68-1214b8f86c72"
>
<ReqRef
 Id="0310893d-d293-4089-ad7f-c6e74d25d402"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="422ed2ff-d3b2-4b9d-b93a-f653b27905a1"
>
</ReqRef><Comment>Contains the previous value of the speed of the train in order to know if the train has reached standstill.</Comment>
</StructureElement><StructureElement
 TypeName="Default.Level"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Level"
 Guid="dfe14e8f-60f2-41d1-a4e2-bfe45f5b2d64"
>
<ReqRef
 Id="a73c2ac0-c4f3-4593-b90c-ba4ee8cc4957"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="88fb8d10-2186-4fd5-bc3a-eec65b47cdd8"
>
</ReqRef><Comment>Contains the previous value of the level in order to know if that value has changed.</Comment>
</StructureElement><StructureElement
 TypeName="Default.Mode"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Mode"
 Guid="0fe0a95b-e6d2-4b3f-a065-860c0a2cea17"
>
<ReqRef
 Id="51d5337f-1430-4900-a7a0-9fc794f74fdb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3354f402-f79e-41af-9fff-c6f5a9ad88db"
>
</ReqRef><Comment>Contains the previous value of the mode in order to know if that value has changed.</Comment>
</StructureElement><StructureElement
 TypeName="Boolean"
 Default="Boolean.False"
 Mode="Internal"
 Implemented="TRUE"
 Name="HasActiveSession"
 Guid="0e42fee9-39f2-4da3-bf59-40f56503187f"
>
<ReqRef
 Id="7650e199-5792-467e-8851-48660d18ee90"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f2fc389c-163a-409a-ab50-88248ccf891e"
>
</ReqRef><Comment>Contains the previous value of session state in order to know if that value has changed.</Comment>
</StructureElement></Structure><Structure
 Default=""
 Implemented="TRUE"
 Name="PositionReportParametersValues"
 Guid="0cfceaa4-617d-4da2-835a-9da4e0f84f51"
>
<ReqRef
 Id="ae550cab-c867-4e9d-af2c-8e62dbe27545"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4e45c620-e6c8-449e-816c-52ad872af845"
>
</ReqRef><ReqRef
 Id="a216803e-5575-472e-bbd0-bfaa483382b7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0bbe34d7-d7ce-4d81-a106-19baf7bde62e"
>
</ReqRef><ReqRef
 Id="8e46d1f9-ece2-43e9-9a45-e2978111a3dc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5345377f-dea6-446b-8e0f-f68d3a590b32"
>
</ReqRef><Comment>Parameters of position reporting given by RBC.</Comment>
<StructureElement
 TypeName="Default.BaseTypes.Time"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="TimeInterval"
 Guid="687f8957-1f6e-45f1-b69b-a9e607d1194c"
>
<ReqRef
 Id="2ad61dc3-1f8d-4e29-888b-5d0a9df1e5cf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="511735ab-525d-47db-826e-f23458a0a87e"
>
</ReqRef><Comment>The periodic time interval when a position report has to be sent.</Comment>
</StructureElement><StructureElement
 TypeName="Default.BaseTypes.Distance"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="DistanceInterval"
 Guid="c7e38d7a-e78e-4c47-aac5-b6497179ff9b"
>
<ReqRef
 Id="9bce1dcb-f670-481c-9012-c9772b746a32"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="947e0a12-8289-4d58-8073-ff08878f96f4"
>
</ReqRef><Comment>The periodic distance interval when a position report has to be sent.</Comment>
</StructureElement><StructureElement
 TypeName="PositionReportSpecialLocation"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SpecialLocation"
 Guid="c76f861d-b33d-48e7-8f7f-a6ebd3e6b90e"
>
<ReqRef
 Id="5bc210dc-ac9e-4d2a-9508-b89f3d465a7b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="89a71b21-5286-46a6-a4a0-43a59d3509b7"
>
</ReqRef><ReqRef
 Id="3c43c95f-9a2d-4244-a81b-8ce6833a6a96"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4f2489cb-1e12-4bc1-b4d1-cb1e5b5ef7b0"
>
</ReqRef><ReqRef
 Id="aa035c94-e9a5-4a0d-80ed-80d1a0e9db3f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ad05d477-180f-4a70-83e0-713dc9b6cbbd"
>
<Comment>This requirement is always satisfied because the value of the field PositionReportSpecialLocation can be either LRBG or Now and never the both together.</Comment>
</ReqRef><Comment>A special location when a position report has to be sent.</Comment>
</StructureElement><StructureElement
 TypeName="PositionReportLocations"
 Default=""
 Mode="Incoming"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Locations"
 Guid="fdd2c7b2-cab4-4f62-9a29-a8f986e6016f"
>
<ReqRef
 Id="12080437-12c5-47ab-9aec-ceced6bba68f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="23a80406-b674-43a5-9e8a-129b78b93722"
>
</ReqRef><Comment>The locations where the position report has to be sent.</Comment>
</StructureElement></Structure><Structure
 Default=""
 NeedsRequirement="FALSE"
 Name="PositionReportParameters"
 Guid="dafba94d-6433-44d4-9e3f-ba35ffadb8ea"
>
<Comment>Contains position report parameters given by the RBC.</Comment>
<StructureElement
 TypeName="Default.DataState"
 Default=""
 Mode="Internal"
 NeedsRequirement="FALSE"
 Name="DataState"
 Guid="05e8cb01-1d61-4e80-bcaa-11d314b7ab34"
>
<Comment>The data state of report parameters.</Comment>
</StructureElement><StructureElement
 TypeName="PositionReportParametersValues"
 Default=""
 Mode="Incoming"
 NeedsRequirement="FALSE"
 Name="Values"
 Guid="e3fce09b-5758-403f-8751-cb7438db0924"
>
<Comment>The position report parameters.</Comment>
</StructureElement></Structure><Structure
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="LastPositionReportInformation"
 Guid="f69c4eae-36c3-4704-8ae3-4d74ffbed1b7"
>
<Comment>Keeps the information about the last report.</Comment>
<StructureElement
 TypeName="Default.BaseTypes.Time"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Time"
 Guid="2c77c80c-ecb4-4967-aaba-3484ca357c06"
>
<ReqRef
 Id="2ad61dc3-1f8d-4e29-888b-5d0a9df1e5cf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="97943dfe-78b0-4c13-8031-1416b87c53ef"
>
</ReqRef><ReqRef
 Id="60acc0ca-e056-4297-ae12-7f37389323d3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5252e3f0-2439-46a0-8345-93770c0310b1"
>
</ReqRef><Comment>The time of the last position report.</Comment>
</StructureElement><StructureElement
 TypeName="Default.BaseTypes.Distance"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Position"
 Guid="3a74034d-e43e-4db0-85ed-16ef9093a145"
>
<ReqRef
 Id="9bce1dcb-f670-481c-9012-c9772b746a32"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="53833c15-3196-4533-b745-9e2e693d6384"
>
</ReqRef><Comment>The position of the last position report.</Comment>
</StructureElement><StructureElement
 TypeName="BTM.BaliseGroup"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="LRBG"
 Guid="aca04f80-cae6-4046-8486-cdcd0165d683"
>
<ReqRef
 Id="3c43c95f-9a2d-4244-a81b-8ce6833a6a96"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3d95f0aa-14a5-4a75-94a3-f22873d343a9"
>
</ReqRef><Comment>The LRBG according to which the last position report was sent.</Comment>
</StructureElement></Structure><Structure
 Default=""
 Implemented="TRUE"
 Name="PositionLocation"
 Guid="22647d7a-ba05-4975-8cb5-f8392fab6640"
>
<ReqRef
 Id="12080437-12c5-47ab-9aec-ceced6bba68f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4decd675-9b9a-4e99-9a7b-cf36f4681375"
>
</ReqRef><Comment>The specified location that, once passed by the train, should provoke the sending of a new position report.</Comment>
<StructureElement
 TypeName="Default.BaseTypes.Distance"
 Default=""
 Mode="Incoming"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Distance"
 Guid="6cbe6c7e-36e3-4867-9a9e-44716f89b5a8"
>
<ReqRef
 Id="26b2f0b0-1aee-4778-99cf-b5d01eb56627"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="387b6c06-2c64-4504-a351-bef01392fb73"
>
</ReqRef><Comment>Distance that has to be passed in order to send a new position report.</Comment>
</StructureElement><StructureElement
 TypeName="TrainData.TrainEndEnum"
 Default=""
 Mode="Incoming"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="TrainEnd"
 Guid="51582ceb-41cc-4f21-80a1-aa76cdf21000"
>
<ReqRef
 Id="e5ec5ab9-bbf7-43ce-aee2-703517236f43"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8f51a051-7939-4734-8130-1af784799527"
>
</ReqRef><Comment>Indicates if the distance has to be passed with the max safe front end or the min safe rear end of the train.</Comment>
</StructureElement></Structure></Structures>
<Collections>
<Collection
 TypeName="PositionLocation"
 MaxSize="32"
 Default="[]"
 Name="PositionReportLocations"
 Guid="65a363a1-fc0b-412a-8b6f-2d68bc7fe4d4"
>
<ReqRef
 Id="12080437-12c5-47ab-9aec-ceced6bba68f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7f0b3f25-c0de-4842-b980-b8655e5ce454"
>
</ReqRef><Comment>List of locations where a position report has to be sent.</Comment>
</Collection></Collections>
<Functions>
<Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 Name="SendReportDueToCommunicationSessionIsEstablished"
 Guid="06396c3e-d71c-45c8-8a5f-01b87812bd95"
>
<ReqRef
 Id="7650e199-5792-467e-8851-48660d18ee90"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5357decc-14e6-459a-86b1-8c8348764169"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to communication session establishment.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="38910f57-eaaa-45c2-8562-0f00ec822b4b"
>
<Expression>PositionReportEventsTracker.HasActiveSession == Boolean.False</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToLevelChange"
 Guid="288fe7d5-072a-4cb4-b491-d43752f16310"
>
<ReqRef
 Id="a73c2ac0-c4f3-4593-b90c-ba4ee8cc4957"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4b9d39f9-3b1e-4fe4-827a-e87370db6bba"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to the level change.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="2267941e-218a-4012-9fe6-34f016f07663"
>
<Expression>PositionReportEventsTracker.Level != Kernel.Level.Value</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToLossOfTrainIntegrityDetected"
 Guid="845d881a-6178-4569-b16f-1e6a2f9ba2df"
>
<ReqRef
 Id="5e354f4a-2bd0-458a-983a-75be865356d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="51b45c95-767f-4a31-b29a-59105f7378a7"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to loss of train integrity.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="971ecd82-8414-41b3-b1b4-7dd8e9b80181"
>
<Expression>PositionReportEventsTracker.TrainIntegrityStatus != TIU.TrainIntegrity.Status
  AND
TIU.TrainIntegrity.Status == Messages.Q_LENGTH.Train_integrity_lost</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToModeChange"
 Guid="1023a58f-3dfb-42af-92ce-408194247e71"
>
<ReqRef
 Id="51d5337f-1430-4900-a7a0-9fc794f74fdb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="77b85189-1394-485f-b51b-729b18896fb8"
>
<Comment></Comment>
</ReqRef><ReqRef
 Id="9f9eccce-90aa-4339-8dff-74915b041b83"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="37d5120a-c6b1-4174-b595-9b2ef6def822"
>
</ReqRef><ReqRef
 Id="1e84c5a2-c916-45da-94c9-cdf6585f39c9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4a45e4c6-7ec1-43e4-921e-b9e3125d4558"
>
</ReqRef><ReqRef
 Id="0dc5d937-27a9-4c96-a97d-dfdbe75c85d9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c0f2c45c-122e-45d9-8856-41b90ee5bb1d"
>
</ReqRef><ReqRef
 Id="cd15246a-5c87-478b-bc9e-36ed9f2f9127"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ae6e296d-103d-44de-8009-4cbbd5d73d8e"
>
</ReqRef><ReqRef
 Id="edf4ce85-46d4-4827-9f52-c859b33c7c8d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="958fd520-a5ed-42ef-8199-89ec5baa8467"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to the mode change.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="5dceb123-fe06-4e6a-8ded-c6c2984cebe4"
>
<Expression>PositionReportEventsTracker.Mode != Kernel.Mode</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToPositionReportTimeReached"
 Guid="f61e474a-4323-4285-ad21-a9b6103b3a12"
>
<ReqRef
 Id="2ad61dc3-1f8d-4e29-888b-5d0a9df1e5cf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0b40b0f5-773a-4ef1-bdcf-49f0eda24ff2"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to time to send a position report reached.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="aaa72c64-bb2e-466c-93eb-5bf924372ffc"
>
<Expression>Kernel.CurrentTime &gt;= LastPositionReport.Time + PositionReportParameters.Values.TimeInterval AND PositionReportParameters.DataState == Default.DataState.Valid AND PositionReportParameters.Values.TimeInterval != 0.0</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToPositionReportDistanceReached"
 Guid="998de66e-d6a4-47c6-8eeb-235cf27d723d"
>
<ReqRef
 Id="9bce1dcb-f670-481c-9012-c9772b746a32"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d2543aac-c3e4-43c4-a662-302e248412bd"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to position report distance reached.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="3bcde522-0efd-4e95-9c56-00ee9dbe3059"
>
<Expression>(Odometry.NominalDistance &gt;= (LastPositionReport.Position + PositionReportParameters.Values.DistanceInterval)) AND (PositionReportParameters.DataState == Default.DataState.Valid) AND (PositionReportParameters.Values.DistanceInterval != Default.BaseTypes.Distance.Infinity)</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToSpecialLocationNow"
 Guid="84d7f642-0a9a-46ca-b0e3-977a5fe3ec73"
>
<ReqRef
 Id="5bc210dc-ac9e-4d2a-9508-b89f3d465a7b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="510261da-dfb8-4672-9c08-b3af809ece5f"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to special location Now.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="d39cbac2-cb23-4eef-a013-bccca1716554"
>
<Expression>PositionReportParameters.Values.SpecialLocation == PositionReportSpecialLocation.Now</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToStandstillReached"
 Guid="cbe675fd-6bde-4d48-81b3-9e4935d4d8ec"
>
<ReqRef
 Id="0310893d-d293-4089-ad7f-c6e74d25d402"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2690fd19-425e-42e0-a919-981196c4b422"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to standstill reached.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="9067bdff-9b40-4532-9e37-c911b007f3db"
>
<Expression>PositionReportEventsTracker.Speed != Odometry.EstimatedSpeed AND Odometry.EstimatedSpeed == 0.0</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToTrainIntegrityConfirmedByDriver"
 Guid="5bb62493-e9e4-48e5-8ecf-49cb55b2ad85"
>
<ReqRef
 Id="08ae9142-b051-4a16-ad2f-f7e7d927a51e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bdf155da-5c71-4289-aebc-c341580be424"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to train integrity confirmed by driver.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="b4a5f2d7-356a-4eb5-b5c5-e979531e600f"
>
<Expression>PositionReportEventsTracker.TrainIntegrityStatus != TIU.TrainIntegrity.Status
  AND 
TIU.TrainIntegrity.Status in [
  Messages.Q_LENGTH.Train_integrity_confirmed_by_driver,
  Messages.Q_LENGTH.Train_integrity_confirmed_by_integrity_monitoring_device
]</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportDueToPositionReportSpecialLocationReached"
 Guid="466e4d39-37fb-47a7-bb94-61b8beb9c698"
>
<ReqRef
 Id="5bc210dc-ac9e-4d2a-9508-b89f3d465a7b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f2e8436c-0fa7-4d7d-b358-3bd1757876a9"
>
</ReqRef><ReqRef
 Id="3c43c95f-9a2d-4244-a81b-8ce6833a6a96"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c3e0b5f6-c7df-47bb-8ab6-f48f8104a2ae"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to position report special location reached.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="8e7cde14-f71d-4b3b-afd0-3d60e81ba553"
>
<Expression>SendReportDueToSpecialLocationNow() OR SendReportDueToSpecialLocationLRBGCompliantBG()</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 NeedsRequirement="FALSE"
 Name="SendReportDueToLRBGCompliantBGPassed"
 Guid="6deafe8f-5156-4e8d-b53b-48a9f7361756"
>
<ReqRef
 Id="d2a0c77e-82a9-493a-b6c6-892dfdc8298f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e3f5328b-dc54-4bf5-bd3b-1427750e89ce"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to the passage of an LRBG compliant BG.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="48204b28-2e0f-4a18-b93d-684c07d63427"
>
<Expression>False</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 NeedsRequirement="FALSE"
 Name="SendReportDueToLevelTransitionBorderPassedWithMinSafeRearEnd"
 Guid="653f40d4-26f6-4bd3-a8f7-37dc03dcb5ef"
>
<ReqRef
 Id="de95016e-13da-4a9a-8a87-17139648fd40"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="73e27a1b-0ae1-443d-9777-8fde6f13b382"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to the passage of level transition border with the min safe rear end.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="3cdf6774-c76a-42dd-9aa8-76d918c9c115"
>
<Expression>False</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 NeedsRequirement="FALSE"
 Name="SendReportDueToSpecialLocationLRBGCompliantBG"
 Guid="d82afd23-bb03-4a72-8cbf-8733bb209752"
>
<ReqRef
 Id="3c43c95f-9a2d-4244-a81b-8ce6833a6a96"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8c9c00f8-b393-48a5-9501-fcde47bfb4a2"
>
</ReqRef><Comment>Indicates if a position report has to be sent due to special location LRBG compliant BG.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="e924629c-bec5-4c78-b137-ec70b26429ef"
>
<Expression>False</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendReportNow"
 Guid="a376ac89-d8fe-494b-b2ca-d990c5455aae"
>
<ReqRef
 Id="0310893d-d293-4089-ad7f-c6e74d25d402"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5217c75b-666f-4619-ac7b-d7ef281e411a"
>
</ReqRef><ReqRef
 Id="51d5337f-1430-4900-a7a0-9fc794f74fdb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7794f35c-827e-46b6-8c4b-e945a142d092"
>
</ReqRef><ReqRef
 Id="08ae9142-b051-4a16-ad2f-f7e7d927a51e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8d7300c5-2568-400b-b18a-7b12a45f3183"
>
</ReqRef><ReqRef
 Id="5e354f4a-2bd0-458a-983a-75be865356d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e5a39de8-afe2-4484-9733-185d02d2f180"
>
</ReqRef><ReqRef
 Id="de95016e-13da-4a9a-8a87-17139648fd40"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0d126b6f-3d3c-40c7-aa11-208de64306ad"
>
</ReqRef><ReqRef
 Id="a73c2ac0-c4f3-4593-b90c-ba4ee8cc4957"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2d486638-157f-44a4-b983-ad6d5cc2fc16"
>
</ReqRef><ReqRef
 Id="7650e199-5792-467e-8851-48660d18ee90"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d8eb0bb9-ffb7-403e-ad1a-20310c5ffdc5"
>
</ReqRef><ReqRef
 Id="a64f54ad-1ecf-473d-a008-4d5b80cd7d5e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9eb446d4-d500-47b7-8b3b-745f4688ee07"
>
</ReqRef><ReqRef
 Id="d2a0c77e-82a9-493a-b6c6-892dfdc8298f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4cac353c-9c28-4dba-959c-20a0be447ed1"
>
</ReqRef><ReqRef
 Id="2ad61dc3-1f8d-4e29-888b-5d0a9df1e5cf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ddb8dcbd-b64d-46cf-a617-d57c2f0bea0c"
>
</ReqRef><ReqRef
 Id="9bce1dcb-f670-481c-9012-c9772b746a32"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3cb63510-352e-49bb-b2a5-3628e378f676"
>
</ReqRef><ReqRef
 Id="12080437-12c5-47ab-9aec-ceced6bba68f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="75ca4eb3-1e82-4272-b2a4-53e2b3816bcd"
>
</ReqRef><ReqRef
 Id="3c43c95f-9a2d-4244-a81b-8ce6833a6a96"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c89bd120-998e-4b45-97f4-d981f8eec3b0"
>
</ReqRef><ReqRef
 Id="5bc210dc-ac9e-4d2a-9508-b89f3d465a7b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2d63c175-98ea-4215-9232-99afdca647ca"
>
</ReqRef><ReqRef
 Id="1e84c5a2-c916-45da-94c9-cdf6585f39c9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d2c10bdf-3688-4040-a5a5-c61b3adf0050"
>
</ReqRef><ReqRef
 Id="0dc5d937-27a9-4c96-a97d-dfdbe75c85d9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f8a83a7e-8051-480e-a067-897d9f0ffa0c"
>
</ReqRef><ReqRef
 Id="cd15246a-5c87-478b-bc9e-36ed9f2f9127"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cdc04f74-a89e-4d70-a52a-f3320b4338e4"
>
</ReqRef><ReqRef
 Id="edf4ce85-46d4-4827-9f52-c859b33c7c8d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="afbbc51d-7cd4-4194-9c7a-556ead8acb58"
>
</ReqRef><Comment>Determines if the train has to send a position report to the RBC now.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="95b790d2-b1f1-40e6-808f-05b60c4e9d13"
>
<Expression>(
    BTM.LRBG.Orientation != Orientation.Unknown
        OR
    BTM.PreviousLRBG() != EMPTY
)
    AND
(
    SendReportDueToStandstillReached() OR 
    SendReportDueToModeChange() OR 
    SendReportDueToTrainIntegrityConfirmedByDriver() OR 
    SendReportDueToLossOfTrainIntegrityDetected() OR 
    SendReportDueToLevelTransitionBorderPassedWithMinSafeRearEnd() OR 
    SendReportDueToLevelChange() OR 
    SendReportDueToCommunicationSessionIsEstablished() OR 
    SendReportDueToLRBGCompliantBGPassed() OR 
    SendReportDueToPositionReportDistanceReached() OR 
    SendReportDueToPositionReportSpecialLocationReached() OR
    SendReportDueToPositionReportTimeReached()
)</Expression>
</Case></Cases>
</Function><Function
 Type="PositionReportSpecialLocation"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="ERTMSSpecialLocationConverter"
 Guid="2520f1c3-f3e2-4a0b-a0a7-5a80ee8960a5"
>
<Comment>Used to convert M_LOC values to PositionReport.SpecialLocation values.</Comment>
<Parameters>
<Parameter
 Type="Messages.M_LOC"
 Name="M_LOC"
 Guid="7effdbbf-bc72-4732-a21c-59dfdfa2c32e"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Now"
 Guid="42d2d109-f4d7-45d6-a996-1a7fc0cb66b6"
>
<PreConditions>
<PreCondition
 Guid="35c794c0-5225-4e97-b992-64e1cc0f9013"
>M_LOC == 0</PreCondition></PreConditions>
<Expression>PositionReportSpecialLocation.Now</Expression>
</Case><Case
 Name="LRBG"
 Guid="94794676-4b38-47b1-bdc8-7d102b9b4ab7"
>
<PreConditions>
<PreCondition
 Guid="7a286dfe-aba0-4dbf-84ec-4a50e6e6f4ae"
>M_LOC == 1</PreCondition></PreConditions>
<Expression>PositionReportSpecialLocation.LRBG</Expression>
</Case><Case
 Name="DoNotSend"
 Guid="5f8d4ff4-9ae7-4625-b2fa-8bf772e3d0e7"
>
<PreConditions>
<PreCondition
 Guid="95161b86-ce17-4022-8323-28087be8111d"
>M_LOC == 2</PreCondition></PreConditions>
<Expression>PositionReportSpecialLocation.DoNotSend</Expression>
</Case></Cases>
</Function><Function
 Type="Messages.M_LEVEL"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="FillLevelInformation"
 Guid="6399a313-cf38-4497-9f66-2ff546b2fd8e"
>
<ReqRef
 Id="9f9eccce-90aa-4339-8dff-74915b041b83"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3feb3140-77d4-4847-8aa1-b42141f5cb26"
>
</ReqRef><Comment>Provides the level to be sent in the position report packet.</Comment>
<Cases>
<Case
 Name="LevelChanged"
 Guid="22ea3887-4ad7-458d-a9c9-eeffa9810c0e"
>
<PreConditions>
<PreCondition
 Guid="616052db-8451-4c18-a036-b9769e06293d"
>SendReportDueToLevelChange()</PreCondition></PreConditions>
<Expression>Default.EFSLevelConverter ( Kernel.Level.Value )</Expression>
</Case><Case
 Name="LevelUnchanged"
 Guid="739b61cf-28cc-4829-8d66-31c0f7ba8dd3"
>
<PreConditions>
<PreCondition
 Guid="5b9dfad2-41e8-4396-8a33-d540534ca35a"
>NOT SendReportDueToLevelChange()</PreCondition></PreConditions>
<Expression>EMPTY</Expression>
</Case></Cases>
</Function><Function
 Type="Messages.M_MODE"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="FillModeInformation"
 Guid="b45da76e-4fa4-4a98-ab7a-d60c6ae81202"
>
<ReqRef
 Id="9f9eccce-90aa-4339-8dff-74915b041b83"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8e2100a6-7137-4c5d-9c32-e4432ba30b8d"
>
</ReqRef><Comment>Provides the mode to be sent in the position report packet.</Comment>
<Cases>
<Case
 Name="ModeChanged"
 Guid="e7641b93-82d8-42c7-a415-7557e99b5b30"
>
<PreConditions>
<PreCondition
 Guid="c041d51c-1dc8-4e97-a7bc-08eb52ba266d"
>SendReportDueToModeChange()</PreCondition></PreConditions>
<Expression>Default.EFSModeConverter ( Kernel.Mode )</Expression>
</Case><Case
 Name="ModeUnchanged"
 Guid="0c1d27c7-6b24-443a-9750-dff15bf062ef"
>
<PreConditions>
<PreCondition
 Guid="8d23affe-ea35-40a0-842a-5dd22f5c7e8b"
>NOT SendReportDueToModeChange()</PreCondition></PreConditions>
<Expression>EMPTY</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Length"
 Default=""
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="FillTrainIntegrityInformation"
 Guid="bb5fd216-49ab-4b0e-b1a3-4ef0c8e52bd3"
>
<ReqRef
 Id="9f9eccce-90aa-4339-8dff-74915b041b83"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="503a4f50-50cc-4145-8c66-d512a53e6007"
>
</ReqRef><ReqRef
 Id="1b5d3174-e90a-42a4-8da3-c7ade895d5d2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cab917c1-4d78-4a4e-963d-083c2087b407"
>
</ReqRef><ReqRef
 Id="f20ec9e0-b487-46ab-8145-dcde0dbb9ea6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3a671f53-219a-47a0-9e6d-b97e0a032c03"
>
</ReqRef><ReqRef
 Id="a6a124ce-7f2a-48de-8aa9-787f46d22b8c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7a6980e1-60a1-45d1-bef4-2c17208e8e51"
>
</ReqRef><Comment>Provides the train integrity information to be sent in the position report packet.</Comment>
<Cases>
<Case
 Name="TrainIntegrityConfirmed"
 Guid="80908703-517b-405d-8f22-d1ad760f9266"
>
<PreConditions>
<PreCondition
 Guid="ce99678d-425b-4af1-9727-8bbb0efbfa96"
>TIU.TrainIntegrity.Status in [
  Messages.Q_LENGTH.Train_integrity_confirmed_by_driver,
  Messages.Q_LENGTH.Train_integrity_confirmed_by_integrity_monitoring_device
]</PreCondition></PreConditions>
<Expression>TIU.TrainIntegrity.SafeTrainLength</Expression>
</Case><Case
 Name="TrainIntegrityNotConfirmed"
 Guid="fb2628eb-5e48-4888-961f-13a7650d95a8"
>
<PreConditions>
<PreCondition
 Guid="bffaea8c-ddb4-46cd-b54d-aa8a567f8c89"
>TIU.TrainIntegrity.Status not in [
  Messages.Q_LENGTH.Train_integrity_confirmed_by_driver,
  Messages.Q_LENGTH.Train_integrity_confirmed_by_integrity_monitoring_device
]</PreCondition></PreConditions>
<Expression>EMPTY</Expression>
</Case></Cases>
</Function><Function
 Type="Messages.PACKET.TRAIN_TO_TRACK.POSITION_REPORTS.Message"
 Default=""
 Implemented="TRUE"
 Name="CreatePositionReport"
 Guid="2c0dadbb-d07b-4fb5-8371-d890520965f8"
>
<ReqRef
 Id="366a126c-fe75-41b9-bb69-ee7464cf1272"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4bbcf8c6-5b17-4db9-9e87-4a8597785cda"
>
</ReqRef><ReqRef
 Id="9f9eccce-90aa-4339-8dff-74915b041b83"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5b1e889d-6a01-4da4-a5c4-d38960146ab1"
>
</ReqRef><ReqRef
 Id="1b5d3174-e90a-42a4-8da3-c7ade895d5d2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="dbce64e2-3e18-409c-a6ce-5a3696b7426f"
>
</ReqRef><ReqRef
 Id="e6ece399-f216-4956-a5c8-811ae465ba7b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8747d00b-8ae7-4def-8217-58a8aa1987c4"
>
</ReqRef><ReqRef
 Id="b45f95ad-fa45-4f28-96a0-8f422846828a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a49ae3d0-4594-4440-bd17-f809d414d841"
>
</ReqRef><ReqRef
 Id="1afce2ff-9ca8-4dc6-9a3b-d3533cf3e05b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9c400551-d38d-41b6-8c9b-67a942f33c42"
>
</ReqRef><ReqRef
 Id="4ce2cdd0-a29e-403c-b920-0e635d2d271e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3284acfe-ba21-4b03-8e90-7c553f8d14b8"
>
</ReqRef><ReqRef
 Id="3b95001a-a63a-4085-8dd4-23f27d438dcf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f5abd065-5e06-4a44-bdbb-2426df393c9e"
>
</ReqRef><ReqRef
 Id="b3370684-8140-442d-bc2e-8439f14d6ff8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="67383e8b-04bf-4e6c-8d75-44310428d41a"
>
</ReqRef><ReqRef
 Id="20ceaa9c-c6e7-4c20-b6da-2bf54892b3af"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e1081438-fd75-4a84-bb17-d0e3da3a3bf6"
>
</ReqRef><ReqRef
 Id="a6a124ce-7f2a-48de-8aa9-787f46d22b8c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c98f7d91-a031-4e23-ae0d-9889fb755557"
>
</ReqRef><ReqRef
 Id="1ee16e25-19bc-4c58-b451-ebd13c054d1c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="dca7f580-745b-42e9-bfc7-2673c8fe4fd8"
>
</ReqRef><ReqRef
 Id="2bd96cac-883a-481d-acfa-5d6e3be72eab"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="dcda79b6-6f9b-4360-aa10-3b52807bbce8"
>
</ReqRef><Comment>Creates a position report packet.</Comment>
<Cases>
<Case
 Name="One BG"
 Guid="85eff0a6-7e75-4fd3-9825-9e0a8fbf6192"
>
<PreConditions>
<PreCondition
 Guid="f21e89a9-9a6b-412d-97ad-c87d8656875f"
>BTM.LRBG.Orientation != Orientation.Unknown</PreCondition></PreConditions>
<Expression>Messages.PACKET.TRAIN_TO_TRACK.POSITION_REPORTS.Message
{
    POSITION_REPORT=&gt; Messages.PACKET.TRAIN_TO_TRACK.POSITION_REPORT.Message
    {
        Q_SCALE =&gt; Messages.Q_SCALE._1_m_scaleC,
        NID_LRBG =&gt; BTM.LRBG.NID,
        D_LRBG =&gt; FillDistance(),
        Q_DIRLRBG =&gt; Default.Q_DIRLRBG ( Kernel.TrainPosition.Position.DirectionalPositionInformation.TrainOrientation ),
        Q_DLRBG =&gt; Default.Q_DLRBG ( Kernel.TrainPosition.Position.DirectionalPositionInformation.TrainFrontEndPosition ),
        L_DOUBTOVER =&gt; MessageTypes.UnScaleLength ( Kernel.ConfidenceInterval.ConfidenceInterval(Default.ConfidenceInterval.L_DOUBTOVER), Messages.Q_SCALE._1_m_scaleC ),
        L_DOUBTUNDER =&gt; MessageTypes.UnScaleLength ( Kernel.ConfidenceInterval.ConfidenceInterval(Default.ConfidenceInterval.L_DOUBTUNDER), Messages.Q_SCALE._1_m_scaleC ),
        Q_LENGTH =&gt; TIU.TrainIntegrity.Status,
        L_TRAININT =&gt; MessageTypes.UnScaleLength ( FillTrainIntegrityInformation(), Messages.Q_SCALE._1_m_scaleC),
        V_TRAIN =&gt; MessageTypes.UnResolveSpeed ( Odometry.EstimatedSpeed, 5.0 ),
        Q_DIRTRAIN =&gt; Default.Q_DIRTRAIN ( Kernel.TrainPosition.Position.DirectionalPositionInformation.TrainRunningDirection ),
        M_MODE =&gt; FillModeInformation(),
        M_LEVEL =&gt; FillLevelInformation()
    },
    POSITION_REPORT_BASED_ON_TWO_BALISE_GROUPS =&gt; EMPTY
}</Expression>
</Case><Case
 Name="Two BGs"
 Guid="84e46cd8-5e10-4316-bd28-38f4540024f7"
>
<Expression>Messages.PACKET.TRAIN_TO_TRACK.POSITION_REPORTS.Message
{
    POSITION_REPORT_BASED_ON_TWO_BALISE_GROUPS=&gt;Messages.PACKET.TRAIN_TO_TRACK.POSITION_REPORT_BASED_ON_TWO_BALISE_GROUPS.Message
    {
        Q_SCALE =&gt; Messages.Q_SCALE._1_m_scaleC,
        NID_LRBG =&gt; BTM.LRBG.NID,
        NID_PRVLRBG =&gt; Messages.NID_PRVBG ( BTM.PreviousLRBG().NID ),
        D_LRBG =&gt; FillDistance(),
        Q_DIRLRBG =&gt; Default.Q_DIRLRBG ( Kernel.TrainPosition.Position.DirectionalPositionInformation.TrainOrientation ),
        Q_DLRBG =&gt; Default.Q_DLRBG ( Kernel.TrainPosition.Position.DirectionalPositionInformation.TrainFrontEndPosition ),
        L_DOUBTOVER =&gt; MessageTypes.UnScaleLength ( length =&gt; Kernel.ConfidenceInterval.ConfidenceInterval ( Default.ConfidenceInterval.L_DOUBTOVER ), scale =&gt; Messages.Q_SCALE._1_m_scaleC ),
        L_DOUBTUNDER =&gt; MessageTypes.UnScaleLength ( Kernel.ConfidenceInterval.ConfidenceInterval ( Default.ConfidenceInterval.L_DOUBTUNDER ), scale =&gt; Messages.Q_SCALE._1_m_scaleC ),
        Q_LENGTH =&gt; TIU.TrainIntegrity.Status,
        L_TRAININT =&gt; MessageTypes.UnScaleLength ( FillTrainIntegrityInformation(), Messages.Q_SCALE._1_m_scaleC),
        V_TRAIN =&gt; MessageTypes.UnResolveSpeed ( Odometry.EstimatedSpeed, 5.0 ),
        Q_DIRTRAIN =&gt; Default.Q_DIRTRAIN ( Kernel.TrainPosition.Position.DirectionalPositionInformation.TrainRunningDirection ),
        M_MODE =&gt; FillModeInformation(),
        M_LEVEL =&gt; FillLevelInformation()
    }
}</Expression>
</Case></Cases>
</Function><Function
 Type="Messages.Q_STATUS"
 Default=""
 Implemented="TRUE"
 Name="FillQStatus"
 Guid="b0cba2fa-7765-443d-8e8c-58a283e252bf"
>
<ReqRef
 Id="aa43ddb6-13a5-4b3e-bbcc-bf985bea4175"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="57691381-cc06-49af-9731-9d113138e4f1"
>
</ReqRef><ReqRef
 Id="6375b0de-0293-4d16-abdf-cb5f39a35143"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f7039c91-c473-43fc-8e54-7f90563e2d58"
>
</ReqRef><Comment>Provides the status of train position data to be sent in the position report packet.</Comment>
<Cases>
<Case
 Name="Valid"
 Guid="c8c46f4a-f314-473b-b5c5-96807953b04b"
>
<PreConditions>
<PreCondition
 Guid="6d57e308-168e-4650-ab9e-85fca0dc39b8"
>Kernel.TrainPosition.Position.DataState == DataState.Valid</PreCondition></PreConditions>
<Expression>Messages.Q_STATUS.Valid</Expression>
</Case><Case
 Name="Invalid"
 Guid="238d8964-adb4-4c31-9096-ec53ada49684"
>
<PreConditions>
<PreCondition
 Guid="d494d339-f451-4df2-9360-f9b682c99f11"
>Kernel.TrainPosition.Position.DataState == DataState.Invalid</PreCondition></PreConditions>
<Expression>Messages.Q_STATUS.Invalid</Expression>
</Case><Case
 Name="Unknown"
 Guid="17a9643e-ad95-4bf6-82f0-8a4c9dcf4f5d"
>
<PreConditions>
<PreCondition
 Guid="62c8fb34-1fe4-4b03-889f-f2f00ff6042b"
>Kernel.TrainPosition.Position.DataState == DataState.Unknown</PreCondition></PreConditions>
<Expression>Messages.Q_STATUS.Unknown</Expression>
</Case></Cases>
</Function><Function
 Type="Default.MessageTypes.Distance"
 Default=""
 Implemented="TRUE"
 Name="FillDistance"
 Guid="06a30396-059d-48ce-8307-81d1ef4237e7"
>
<ReqRef
 Id="457bd04c-8b77-4ecc-b5ec-c4dbce5c1e53"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d4db1506-206b-4a5e-8e4c-92086bebeefa"
>
</ReqRef><ReqRef
 Id="b45f95ad-fa45-4f28-96a0-8f422846828a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2434b542-7392-4570-9e56-a1c4989c9dde"
>
</ReqRef><Comment>Provides the distance to be sent in the position report packet.</Comment>
<Cases>
<Case
 Name="Distance unknown"
 Guid="73cc0be4-5aa2-4f8a-a502-c66462dd8d01"
>
<PreConditions>
<PreCondition
 Guid="aaa7bc6b-badb-4e38-9d86-88f46f615afe"
>Kernel.TrainPosition.Position.DataState == DataState.Unknown</PreCondition></PreConditions>
<Expression>MessageTypes.Distance.Unknown</Expression>
</Case><Case
 Name="Distance known"
 Guid="11ec8272-ab63-4022-aa13-66802b914a9b"
>
<Expression>MessageTypes.UnScaleDistance ( BTM.TravelledDistanceFromLRBG(), Messages.Q_SCALE._1_m_scaleC )</Expression>
</Case></Cases>
</Function></Functions>
<Procedures>
<Procedure
 Implemented="TRUE"
 Name="UpdatePositionReportParameters"
 Guid="ab143d6e-de00-4e9d-a8c4-d91206bf6813"
>
<ReqRef
 Id="e832ef89-d8d7-4e89-86eb-ba4c29d6d5fe"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5dcd3caf-a4bc-49ca-8144-1453dc04e357"
>
</ReqRef><Comment>Updates the position report parameters with newly received values.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.POSITION_REPORT_PARAMETERS.Message"
 Name="Packet"
 Guid="06599896-903e-405e-83bb-f4e083cfa85b"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="UpdateOUT"
 Implemented="TRUE"
 Name="UpdatePositionReportParameters"
 Guid="1c9f0244-63e5-4e91-ad5a-fbbff23becb8"
>
<ReqRef
 Id="8e46d1f9-ece2-43e9-9a45-e2978111a3dc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d3e93e00-1d08-4533-b43d-48bbe936161b"
>
</ReqRef><SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="UpdatePositionReportParameters"
 Guid="f5b9ed0c-e0fd-4357-b628-f628b1584cdf"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="bb7d9795-fec8-42f3-a619-fb767260a89d"
>PositionReportParameters.DataState &lt;- Default.DataState.Valid</Action><Action
 Guid="f3e0c810-5538-4ebf-b190-2e4fa7161c79"
>PositionReportParameters.Values.TimeInterval &lt;- BaseTypes.Time ( Packet.T_CYCLOC )</Action><Action
 Guid="bbed578f-bec0-45d5-a457-6c3e192bcb6b"
>PositionReportParameters.Values.DistanceInterval &lt;- MessageTypes.QScaleDistance ( Packet.D_CYCLOC, Packet.Q_SCALE)</Action><Action
 Guid="89290f52-e348-42cd-abb6-f2b2841c62fb"
>PositionReportParameters.Values.SpecialLocation &lt;- ERTMSSpecialLocationConverter(Packet.M_LOC)</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendFirstRBCHandoverPositionReport"
 Guid="32c21d40-8ed4-4f0c-a8d6-15496fe4e247"
>
<ReqRef
 Id="6a61aac6-3496-4cb7-8a7b-8b6d6ee37d62"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fc86b48e-8a79-4bfe-bddb-c7afc04556b1"
>
</ReqRef><ReqRef
 Id="2a5f115c-95a4-4e8f-b29e-965e2f49e9bb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="205f6c84-231e-4bad-9b37-8f78c8646d75"
>
</ReqRef><ReqRef
 Id="78114112-c363-4d6d-8e32-e31931e4a271"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1218db2b-1e32-4f8d-83e0-3ae4379fa7f1"
>
</ReqRef><ReqRef
 Id="bd6563bc-06fe-447b-8afc-e210141cc921"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bc202c8d-245c-4f69-89ac-f284f2c163bb"
>
</ReqRef><ReqRef
 Id="93c1473b-e776-4fae-83f9-f2c0423ab494"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="04c8156f-bc4c-4040-8561-e54d361513a9"
>
</ReqRef><ReqRef
 Id="09eeadf1-fd15-4f7c-8f52-fb0f04b31d9c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a2a18ba7-a87b-4334-bec6-9f52600fe14e"
>
</ReqRef><Comment>Handles the sending of the position report that has to be sent when the max safe front end reaches the transition border location.</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Send position report to the Handing Over RBC"
 Guid="6486cfb7-05a5-4b21-8ff2-fe88b7333743"
>
<Comment>Handles the sending of the position report to the Handling Over RBC.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send position report to the Handing Over RBC"
 Guid="60e15fef-2535-4020-9b03-d7e948afca7d"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="89164f10-4804-45f9-b404-1ba1447d422b"
>NumberOfReportsSentToHandingOverRBC &lt;- 1</Action><Action
 Guid="7a5a51e3-0abe-4698-93ed-043abb09e4d1"
>CurrentRBCConnection().SendPositionReport()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Send position report to the Accepting RBC"
 Guid="9761576a-1b6f-4ba1-9407-a38b7814261a"
>
<Comment>If the on-board is able to handle two RBC connections in parallel, it sends a position report to the accepting RBC as well.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send position report to the Accepting RBC"
 Guid="fd17e342-c46a-4e8d-9cdd-e3ff7329a485"
>
<PreConditions>
<PreCondition
 Guid="7e956f6c-dace-46c8-908e-f325396dda0e"
>SecondaryRBCConnection() != EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="d0ab71e1-786d-4e01-9233-28f40c29267a"
>SecondaryRBCConnection().SendPositionReport()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Change the roles of RBCs"
 Guid="0712c048-71d0-4c3d-9934-12959ae3ecfb"
>
<ReqRef
 Id="377f8ed2-6fd9-420c-a7ae-e9f63416bd1a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7fb04dcf-1d39-48df-827b-02a1a8487cb3"
>
</ReqRef><Comment>After the position report sending, the roles of the RBCs change (the Accepting RBC becomes the main RBC and the Handing Over RBC becomes the secondary).</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Change the roles of RBCs"
 Guid="a377d14a-8dc9-4801-af46-590f9004e35d"
>
<PreConditions>
<PreCondition
 Guid="ddfadecd-e648-4e13-8408-4325274abb95"
>SecondaryRBCConnection() != EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="6b42c60f-a5af-4051-9bc2-4ed9a4530448"
>Terminal1.RBCConnection.IsMainConnection &lt;- NOT Terminal1.RBCConnection.IsMainConnection</Action><Action
 Guid="adfa2013-2b5f-4f01-9977-c806d55f77ab"
>Terminal2.RBCConnection.IsMainConnection &lt;- NOT Terminal2.RBCConnection.IsMainConnection</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle messages receved from the Accepting RBC"
 Guid="da4cfd87-69b6-47aa-a26e-4a56722f42ad"
>
<ReqRef
 Id="c887c56e-758e-426a-a728-cf723b3b2baf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0faf02ab-bf77-4da9-9c84-dd7f27f06cf3"
>
</ReqRef><Comment>Before this position reports, the message received from the Accepting RBC were stored on-board. Now they can be processed.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Handle messages receved from the Accepting RBC"
 Guid="e676e181-4c24-4827-82dc-4411348519f0"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="d8885373-70e7-414c-a68c-046684b5afc4"
>APPLY
  RemoveAcknOfTrainDataFromMessage( aMessage =&gt; X )
ON
  MessagesToHandle</Action><Action
 Guid="6ea871df-0227-4589-bad1-f3714cb01665"
>APPLY
  ProcessIncomingMessages( aMessage =&gt; X )
ON
  MessagesToHandle</Action><Action
 Guid="1d4538da-c21e-436a-80d7-72bfdba26f72"
>MessagesToHandle &lt;- []</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendSecondRBCHandoverPositionReport"
 Guid="751e4f25-3b32-4cf6-9894-4592bff5ea97"
>
<ReqRef
 Id="a10b0fd8-ce50-4ef2-ab36-c41dd3ac7321"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="66a01c08-fe57-4835-9d7c-e09b947a751f"
>
</ReqRef><ReqRef
 Id="55c1b4ba-8b68-4271-a308-24765057ea74"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c69c24db-8924-4f6a-b11b-a013e309d9b5"
>
</ReqRef><ReqRef
 Id="09eeadf1-fd15-4f7c-8f52-fb0f04b31d9c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b101bac1-0a8f-4530-b863-dde5c603734b"
>
</ReqRef><Comment>Sends the position report to the Handing Over RBC, by selecting the right RBC connection according to the configuration of the on-board (one or two terminals available).</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Send second RBC/RBC handover position report"
 Guid="db87e2c2-b506-4231-bacf-987f57622535"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Two RBC connections are available"
 Guid="95a444e5-4527-473a-97cd-322a2a9fcd4e"
>
<Comment>If two RBC connections are available, then the Handing Over RBC has already become the secondary connection.</Comment>
<PreConditions>
<PreCondition
 Guid="e082201c-84ad-4853-91fb-329f7fb6a7b1"
>SecondaryRBCConnection() != EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="35b07ffe-860e-42d4-98bd-0a84888dd618"
>SecondaryRBCConnection().SendPositionReport()</Action><Action
 Guid="11e2aab1-4355-4fc4-be65-995e9d79f494"
>NumberOfReportsSentToHandingOverRBC &lt;- NumberOfReportsSentToHandingOverRBC + 1</Action><Action
 Guid="10b43a01-1386-4f3f-b773-a520fe5bdd33"
>SecondRBCHandoverPositionReportTime &lt;- Kernel.CurrentTime</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Only one RBC connection is available"
 Guid="61032958-e439-46fd-99fa-0ebd44f588ff"
>
<Comment>If only one RBC connection is available, then the Handing Over RBC is still the primary connection.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="4e660aad-b808-4b8f-af10-18728cbb118c"
>CurrentRBCConnection().SendPositionReport()</Action><Action
 Guid="98ee005b-0814-4319-b1f3-3ac3f5840ced"
>NumberOfReportsSentToHandingOverRBC &lt;- NumberOfReportsSentToHandingOverRBC + 1</Action><Action
 Guid="42025d97-0b92-40d7-97ee-d7e5a5385fde"
>SecondRBCHandoverPositionReportTime &lt;- Kernel.CurrentTime</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<Variables>
<Variable
 Type="PositionReportParameters"
 DefaultValue=""
 VariableMode="Incoming"
 Implemented="TRUE"
 Name="PositionReportParameters"
 Guid="113484a5-3bf0-4901-ab04-48f688af408f"
>
<ReqRef
 Id="ae550cab-c867-4e9d-af2c-8e62dbe27545"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b20d1930-a5f4-4f22-a28c-e015ba351cf6"
>
</ReqRef><ReqRef
 Id="a216803e-5575-472e-bbd0-bfaa483382b7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2f3e7607-6e0c-40e9-bb6f-ed3de0a37da6"
>
</ReqRef><Comment>This variable contains the position report parameters given by the RBC.</Comment>
</Variable><Variable
 Type="PositionReportEventsTracker"
 DefaultValue=""
 VariableMode="Internal"
 Implemented="TRUE"
 Name="PositionReportEventsTracker"
 Guid="552bfc53-cebe-4c1a-ab8d-32611eaaf102"
>
<ReqRef
 Id="0310893d-d293-4089-ad7f-c6e74d25d402"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cc2b2b4f-00c5-417b-a66d-aeca2e1653e7"
>
</ReqRef><ReqRef
 Id="51d5337f-1430-4900-a7a0-9fc794f74fdb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c94e606a-d1fa-47a7-8629-9c5357ec787a"
>
</ReqRef><ReqRef
 Id="08ae9142-b051-4a16-ad2f-f7e7d927a51e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0d99f3f1-d51e-474c-913c-587bb9e4f5cb"
>
</ReqRef><ReqRef
 Id="5e354f4a-2bd0-458a-983a-75be865356d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bd315725-10bd-4e22-bf64-2b3a62777299"
>
</ReqRef><ReqRef
 Id="a73c2ac0-c4f3-4593-b90c-ba4ee8cc4957"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0908ce11-0caf-4890-bb9a-e7549dde9e95"
>
</ReqRef><Comment>This variable is used to detect changes of kernel variables (mode, level etc) that can require a position report to RBC.</Comment>
</Variable><Variable
 Type="LastPositionReportInformation"
 DefaultValue=""
 VariableMode="Internal"
 Implemented="TRUE"
 Name="LastPositionReport"
 Guid="67498216-d657-44a5-a0b7-6e7cd8819a67"
>
<ReqRef
 Id="9bce1dcb-f670-481c-9012-c9772b746a32"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3b750e2c-a616-4c0e-87e9-e50e0e978810"
>
</ReqRef><ReqRef
 Id="2ad61dc3-1f8d-4e29-888b-5d0a9df1e5cf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0364ae66-a04f-4638-8cc1-ef019c94e1c7"
>
</ReqRef><ReqRef
 Id="3c43c95f-9a2d-4244-a81b-8ce6833a6a96"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6a30ea7e-c3ba-4759-8cb8-96a7dda20135"
>
</ReqRef><Comment>Indicates when and where the last position report was sent.</Comment>
</Variable><Variable
 Type="Integer"
 DefaultValue="0"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="NumberOfSentReportRepetitions"
 Guid="d96b5ab0-4030-4ae6-839f-1f4ca3db83e7"
>
<ReqRef
 Id="0df24273-c216-4ef5-8d1d-23e83f6d6c2d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d40edde6-c9f0-4baf-839f-22175651a6e4"
>
</ReqRef><Comment>Indicates the number of sent position report repetitions.</Comment>
</Variable><Variable
 Type="BaseTypes.Distance"
 DefaultValue="Default.BaseTypes.Distance.Unknown"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="RBCTransitionLocation"
 Guid="97a617dd-10c7-4bb5-b80a-041544ca0de1"
>
<ReqRef
 Id="67f28124-01be-4b0b-ae62-e6274818f522"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1f7ae591-86b1-4030-b01b-bf668e2f7a42"
>
</ReqRef><ReqRef
 Id="83fd016d-a290-41a0-b91a-d21bdb12a3d1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="868c740c-a2c8-432e-b9ca-8a55c8cb739b"
>
</ReqRef><ReqRef
 Id="8d7f7c64-ed35-4ee2-a511-68029a576144"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9ff0ec4d-25ae-4543-85fb-63c732c79b73"
>
</ReqRef><Comment>Location of the transition to the accepting RBC.</Comment>
</Variable><Variable
 Type="Integer"
 DefaultValue="0"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="NumberOfReportsSentToHandingOverRBC"
 Guid="58fe0255-aaa1-42f1-a66a-123f4836e334"
>
<ReqRef
 Id="67f28124-01be-4b0b-ae62-e6274818f522"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="55aa6103-e49d-4b92-8df4-9a4406a7e969"
>
</ReqRef><ReqRef
 Id="83fd016d-a290-41a0-b91a-d21bdb12a3d1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0220b530-97e4-4192-b39a-d5a9408d3ce8"
>
</ReqRef><Comment>Indicates the number of position reports that were already sent to the Handing Over RBC.</Comment>
</Variable><Variable
 Type="BaseTypes.Time"
 DefaultValue="0.0"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="SecondRBCHandoverPositionReportTime"
 Guid="d3f80e0c-a75b-40d5-aceb-27f16bfaee58"
>
<ReqRef
 Id="d8eba2a2-5b1e-4e5f-878d-ead661e95e50"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3ec06c7b-091e-489e-9d6c-50810f4d881e"
>
</ReqRef><ReqRef
 Id="17777577-ec39-4845-8347-17b8ec4c74d4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="951b89fb-97c0-48d6-b02e-46e1a8f3b97b"
>
</ReqRef><Comment>Indicates the time when the second position report to the Handing Over RBC was sent.</Comment>
</Variable></Variables>
<Rules>
<Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Clean up"
 Guid="728c26b7-570e-4d32-b6cb-6af762241ac4"
>
<Comment>Updates the followers of events that could trigger the sending of position report parameters.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Clean up"
 Guid="5a196179-422d-4e6b-becf-bf5ada482ed1"
>
<PreConditions>
</PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="CommunicationSessionState"
 Guid="fa75f6c0-aad1-4de7-adb8-492e75acb2e8"
>
<Comment>Updates the state of the communication session.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="CommunicationSessionState"
 Guid="09614cfa-a405-4baa-b9cc-d4b95df5748d"
>
<PreConditions>
<PreCondition
 Guid="b5b3bdcf-5b20-47eb-a2c1-2cc56eeffb29"
>PositionReportEventsTracker.HasActiveSession != EURORADIO.HasActiveSession()</PreCondition></PreConditions>
<Actions>
<Action
 Guid="f253a472-4a0b-4830-9daf-dc9f1d297a47"
>PositionReportEventsTracker.HasActiveSession &lt;- EURORADIO.HasActiveSession()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Level"
 Guid="013b22f0-ed85-42da-8942-a930b0fde9a8"
>
<Comment>Updates the value of the level.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Level"
 Guid="6d49b62f-15e0-4aa3-b377-d0af1e9fb393"
>
<PreConditions>
<PreCondition
 Guid="49677e46-1ad5-40a9-af59-160a893d7fa9"
>PositionReportEventsTracker.Level != Kernel.Level.Value</PreCondition></PreConditions>
<Actions>
<Action
 Guid="515acf5a-9876-4a6f-a73b-ca4bf8d4188f"
>PositionReportEventsTracker.Level &lt;- Kernel.Level.Value</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Mode"
 Guid="f2ebd5e5-3246-4fba-8332-76750bd830db"
>
<Comment>Updates the value of the mode.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Mode"
 Guid="0a5bf594-ed6f-446e-80d9-db262c4517c7"
>
<PreConditions>
<PreCondition
 Guid="5db42a2c-f937-4f32-a925-9c7b4f8337fd"
>PositionReportEventsTracker.Mode != Kernel.Mode</PreCondition></PreConditions>
<Actions>
<Action
 Guid="a40ed2af-fb9d-49e3-a621-997105f90762"
>PositionReportEventsTracker.Mode &lt;- Kernel.Mode</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="TrainIntegrity"
 Guid="f163185a-7782-4814-bf5d-1e1dafbe8b9f"
>
<Comment>Updates the value of the train integrity.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="TrainIntegrity"
 Guid="2d86582e-de31-4fab-a563-66eb3d6a1694"
>
<PreConditions>
<PreCondition
 Guid="e9d87099-edc8-4dea-bdd4-ab5fd6b85fae"
>PositionReportEventsTracker.TrainIntegrityStatus != TIU.TrainIntegrity.Status</PreCondition></PreConditions>
<Actions>
<Action
 Guid="03674022-99fb-4c9a-913c-c3686ac1025e"
>PositionReportEventsTracker.TrainIntegrityStatus &lt;- TIU.TrainIntegrity.Status</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Speed"
 Guid="a38605ca-42a6-452b-a2cd-0b106c885156"
>
<Comment>Updates the value of the speed.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Speed"
 Guid="afbe17aa-9778-4985-adbf-7ef3f092648e"
>
<PreConditions>
<PreCondition
 Guid="4ff8ab1e-553f-4bc5-9e31-9cdf9c890e0a"
>PositionReportEventsTracker.Speed != Odometry.EstimatedSpeed</PreCondition></PreConditions>
<Actions>
<Action
 Guid="f06ea1a9-ebb0-4f14-89bd-3d61fbc07ba2"
>PositionReportEventsTracker.Speed &lt;- Odometry.EstimatedSpeed</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SpecialLocation"
 Guid="49997566-1993-4362-a440-57073f46cf9b"
>
<Comment>If a position report was sent due to a special location Now, retain that it doesn&apos;t have to be sent again due to this event.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SpecialLocation"
 Guid="0aeae08a-4952-4b7e-8391-3a741e289b7d"
>
<PreConditions>
<PreCondition
 Guid="01e9965d-e63e-492a-8fd6-d2abb46ca74d"
>PositionReportParameters.Values.SpecialLocation == PositionReportSpecialLocation.Now</PreCondition></PreConditions>
<Actions>
<Action
 Guid="ce1b2dac-1a95-4367-9e31-0328b192cae8"
>PositionReportParameters.Values.SpecialLocation &lt;- PositionReportSpecialLocation.DoNotSend</Action><Action
 Guid="465e9a0b-308d-4a86-a7e3-75ee18e0f703"
>LastPositionReport.Time &lt;- Kernel.CurrentTime</Action><Action
 Guid="6541046c-0889-4cf3-9a50-e0778f68cb93"
>LastPositionReport.Position &lt;- Odometry.NominalDistance</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="PositionReportTimeInterval"
 Guid="9e80ddfb-8e45-4e20-a552-20cfbf31531e"
>
<Comment>If a position report was sent due to the position report time interval reached, the current time is stored.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="PositionReportTimeInterval"
 Guid="772bf26c-aac0-448e-8a1f-c590508bb7cf"
>
<PreConditions>
<PreCondition
 Guid="06f45f9c-043b-4bbc-b95c-80f3dff05f14"
>SendReportDueToPositionReportTimeReached()</PreCondition></PreConditions>
<Actions>
<Action
 Guid="d52d054b-2c95-4bcb-b1f0-f2cb70ee9265"
>LastPositionReport.Time &lt;- Kernel.CurrentTime</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="CleanUp"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="PositionReportDistanceInterval"
 Guid="d04487bb-928e-4ac0-a152-e5eee431f3c9"
>
<Comment>If a position report was sent due to the position report distance interval reached, the current distance is stored.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="PositionReportDistanceInterval"
 Guid="876d4ee0-e43f-44f6-913c-c54346fcd6d9"
>
<PreConditions>
<PreCondition
 Guid="5dfc878b-69eb-4c7a-bb0e-ce7e410d873a"
>SendReportDueToPositionReportDistanceReached()</PreCondition></PreConditions>
<Actions>
<Action
 Guid="62ca8361-552c-4f8d-a5af-7a2d6bd64455"
>LastPositionReport.Position &lt;- Odometry.NominalDistance</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Position reports to accepting RBC counter clean up"
 Guid="d3685868-86bc-4006-af6f-ec75b28ff7cf"
>
<Comment>If both reports were sent, reset the counter to 0.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Position reports to accepting RBC counter clean up"
 Guid="51c9c7c6-e513-4d1f-9e2f-dec478354657"
>
<PreConditions>
<PreCondition
 Guid="9e597c5e-8972-45f9-9d7b-02b17dd66b8c"
>NumberOfReportsSentToHandingOverRBC == 2</PreCondition></PreConditions>
<Actions>
<Action
 Guid="ba49bc15-c471-41a1-b203-6cf28b8868a4"
>NumberOfReportsSentToHandingOverRBC &lt;- 0</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Send position report"
 Guid="e1127980-df0f-4a33-8d9d-ebef6c03e08b"
>
<ReqRef
 Id="ff0f5831-c94a-4b39-b850-e16770555201"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="412cab51-96e9-4afa-a5d2-48259bb7b203"
>
</ReqRef><ReqRef
 Id="ae550cab-c867-4e9d-af2c-8e62dbe27545"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0e17fa22-8cab-4cdc-87e0-9a34f82195b3"
>
</ReqRef><ReqRef
 Id="1e84c5a2-c916-45da-94c9-cdf6585f39c9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3cdcb436-dcfc-4f18-8b8e-e79447be3418"
>
</ReqRef><ReqRef
 Id="0dc5d937-27a9-4c96-a97d-dfdbe75c85d9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7a28d389-5442-49e3-8656-1c779cf41eba"
>
</ReqRef><ReqRef
 Id="cd15246a-5c87-478b-bc9e-36ed9f2f9127"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0ff53960-e822-431f-b184-d3682bad6225"
>
</ReqRef><ReqRef
 Id="edf4ce85-46d4-4827-9f52-c859b33c7c8d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6ad5a9c0-7271-40fb-880d-57136224cd9c"
>
</ReqRef><Comment>If one of conditions to send the position report is satisfied, the rule sends a position report.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Send position report"
 Guid="da2401e1-0c86-4c1f-88d9-c40eb40850f0"
>
<Comment></Comment>
<PreConditions>
<PreCondition
 Guid="c0cd5727-43a9-490a-adb3-b7ab7cfac417"
>SendReportNow()</PreCondition></PreConditions>
<Actions>
<Action
 Guid="caed2442-a4dd-49e2-9bb4-55a01c80b907"
>CurrentRBCConnection().SendPositionReport()</Action></Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Two RBC connections available"
 Guid="8b99bed5-d9ad-4a6f-85b4-838f1489bd2d"
>
<ReqRef
 Id="e48c27fe-8961-45a6-aa65-e8d83fd609ed"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ba2ef206-6817-4f16-af4f-2a9795f5d394"
>
</ReqRef><Comment>If the on-board has a communication session with an Accepting RBC, it sends position report to both RBC connections.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Two RBC connections available"
 Guid="ac93f1c8-194f-4179-b1d1-5dbf6f7f9296"
>
<PreConditions>
<PreCondition
 Guid="a9c9c62a-a1ff-45f5-8f47-71e4e1b756dd"
>SecondaryRBCConnection() != EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="44e5a4e8-73a9-4879-9844-f4bf9665e010"
>SecondaryRBCConnection().SendPositionReport()</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle first RBC/RBC handover position report"
 Guid="2337f4ba-61ce-4bb6-a87c-142256ffec21"
>
<ReqRef
 Id="6a61aac6-3496-4cb7-8a7b-8b6d6ee37d62"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7816945f-e6f1-45b6-a4c0-21a265fe149f"
>
</ReqRef><ReqRef
 Id="277de94f-c4cd-4612-97ca-ead1fdd29073"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f8a726be-9e16-4613-8e71-45702cd6c487"
>
</ReqRef><ReqRef
 Id="67f28124-01be-4b0b-ae62-e6274818f522"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cbded3c7-635c-495f-a803-764110d5ef36"
>
</ReqRef><ReqRef
 Id="5a5b679d-1bf8-4a70-b313-599b2973a034"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1fe99d63-565e-476f-a48e-bc6bfd3a0726"
>
</ReqRef><ReqRef
 Id="dba4721e-ecc7-46a8-945a-ca408198338c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a91b06a3-12d7-4552-a2eb-758e7d5c53ab"
>
</ReqRef><ReqRef
 Id="2a5f115c-95a4-4e8f-b29e-965e2f49e9bb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7575a941-9397-416d-9d60-8ea42926491b"
>
</ReqRef><ReqRef
 Id="78114112-c363-4d6d-8e32-e31931e4a271"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a7595ec3-aa98-4170-bc7b-639e84e4ce07"
>
</ReqRef><ReqRef
 Id="bd6563bc-06fe-447b-8afc-e210141cc921"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a785e4c8-71c4-4f34-83ad-5fa1fa09ee51"
>
</ReqRef><ReqRef
 Id="e946be20-19a1-4857-a5d8-82474ef6d451"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f735e2b5-23af-4b66-8124-8a941cf86e56"
>
</ReqRef><ReqRef
 Id="93c1473b-e776-4fae-83f9-f2c0423ab494"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f780cdf3-9a29-4c98-9b38-947f6bb24b46"
>
</ReqRef><ReqRef
 Id="dba00c16-82a7-40b8-b31c-2978dd6bbd82"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="89670bb6-f102-4efa-b638-117a6c86ef7c"
>
</ReqRef><ReqRef
 Id="09eeadf1-fd15-4f7c-8f52-fb0f04b31d9c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b592b6c3-ada5-4b51-809b-9f3237e9b88a"
>
</ReqRef><Comment>During the RBC/RBC handover, the first position report has to be sent when the max safe front end of the train passes the transition border location.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Handle first RBC/RBC handover position report"
 Guid="c18aa449-79fa-4a8c-94bb-9d212e2a9fc6"
>
<PreConditions>
<PreCondition
 Guid="8759fa6c-ccb2-4799-901c-da387590d178"
>NumberOfReportsSentToHandingOverRBC == 0
  AND
Kernel.TrainPosition.FrontEndPosition ( PointOfInterest =&gt; DistanceInterval.Max ) &gt;= RBCTransitionLocation</PreCondition><PreCondition
 Guid="8ddbf2b5-1a20-4b70-abcd-734965454ea6"
>RBCTransitionLocation != BaseTypes.Distance.Unknown</PreCondition></PreConditions>
<Actions>
<Action
 Guid="daf467de-6386-457f-8555-9fbf8706549b"
>SendFirstRBCHandoverPositionReport()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle second RBC/RBC handover position report"
 Guid="cbe0655b-f287-403a-adcb-788c75b9a498"
>
<ReqRef
 Id="277de94f-c4cd-4612-97ca-ead1fdd29073"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="354f8873-6fcc-4031-94f6-c7c7ab6eb642"
>
</ReqRef><ReqRef
 Id="83fd016d-a290-41a0-b91a-d21bdb12a3d1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f8bf3a3f-567d-4f80-b35d-7f222ac58ba6"
>
</ReqRef><ReqRef
 Id="a10b0fd8-ce50-4ef2-ab36-c41dd3ac7321"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1a6d145d-ca0b-4e57-9d31-de395b00f2af"
>
</ReqRef><ReqRef
 Id="55343d73-fc95-4398-9bb4-d3d7afeea7b8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="35bad9b3-fed2-40b4-9c26-3e3cda9a054e"
>
</ReqRef><ReqRef
 Id="dba4721e-ecc7-46a8-945a-ca408198338c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8182b1e6-8e24-4f7c-acd6-a513e4f3c2fd"
>
</ReqRef><ReqRef
 Id="55c1b4ba-8b68-4271-a308-24765057ea74"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ec73871a-632c-42b0-a365-346538a44e24"
>
</ReqRef><ReqRef
 Id="44972496-d7f5-4a3e-9e31-f4f3060bc841"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b6285c53-b761-4517-9f04-7d4056ce4cdb"
>
</ReqRef><ReqRef
 Id="bd6563bc-06fe-447b-8afc-e210141cc921"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1480eb7b-23bd-484f-a5d7-d37ef0ded1b4"
>
</ReqRef><ReqRef
 Id="e946be20-19a1-4857-a5d8-82474ef6d451"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b3a211e2-b232-4280-ac7a-421a0e932e3f"
>
</ReqRef><ReqRef
 Id="1d33b0f5-c87d-4d19-912f-cd058e370e5a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="795b31f5-e45d-4ac9-9168-e875cd6e8835"
>
</ReqRef><ReqRef
 Id="dba00c16-82a7-40b8-b31c-2978dd6bbd82"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="68f66f31-be48-4c3f-be9b-31749ee7abc5"
>
</ReqRef><ReqRef
 Id="09eeadf1-fd15-4f7c-8f52-fb0f04b31d9c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ec9d6317-d8a2-4e6e-afa8-28514e3ee311"
>
</ReqRef><ReqRef
 Id="65ee1a94-4e54-4675-a3fa-475b64b323d4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4bc5080f-03a7-4e23-97c6-752936658ed9"
>
</ReqRef><ReqRef
 Id="058ba686-ff06-4bed-b616-68b4fb4ea7fd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8f78d90c-bc0b-45ac-b8c5-2d9aa3a216e7"
>
</ReqRef><Comment>During the RBC/RBC handover, the second position report has to be sent when the min safe rear end of the train passes the transition border location.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Handle second RBC/RBC handover position report"
 Guid="e023ee67-9aed-4dea-9eb1-017bdaa69f3d"
>
<Comment>Conditions are met to send the second position report.</Comment>
<PreConditions>
<PreCondition
 Guid="2e4c2276-a2dd-4f4c-8fcb-9857d72cb4c8"
>RBCTransitionLocation != Default.BaseTypes.Distance.Unknown</PreCondition><PreCondition
 Guid="9e01e492-5354-4383-a8cf-c25c076c9526"
>NumberOfReportsSentToHandingOverRBC == 1
  AND
Kernel.TrainPosition.RearEndPosition ( PointOfInterest =&gt; Default.DistanceInterval.Min ) &gt;= RBCTransitionLocation</PreCondition></PreConditions>
<Actions>
<Action
 Guid="6c6ff4dc-2494-496b-b9bf-11fe670cc4b7"
>SendSecondRBCHandoverPositionReport()</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Handing Over RBC has sent an order to terminate the session"
 Guid="e9ed8c4a-83a6-4771-9fb5-5e084e7ca861"
>
<Comment>If Handing over RBC has sent an order to terminate the session, the number of sent position reports is reset to 0 in order to stop repetitions of position reports sendings.</Comment>
<PreConditions>
<PreCondition
 Guid="56ed0c09-a13a-456e-b5ed-fc884e8b4f3f"
>EURORADIO.OrderToTerminateHandingOverRBCIsReceived()</PreCondition></PreConditions>
<Actions>
<Action
 Guid="56171646-7f3d-4717-8553-731700087a4f"
>NumberOfReportsSentToHandingOverRBC &lt;- 0</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="No order to terminate the session received from Handing Over RBC before the timeout =&gt; send a new position report."
 Guid="4cde631d-2493-4c9c-a19c-d3bedfc766ff"
>
<ReqRef
 Id="17777577-ec39-4845-8347-17b8ec4c74d4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="18563c64-cfa2-4e07-bfbf-6e6f762fa5dd"
>
</ReqRef><Comment>If no order to terminate the session is received from Handing Over RBC before the timeout =&gt; send a new position report.</Comment>
<PreConditions>
<PreCondition
 Guid="b18ba555-56bf-429c-8587-9d2262a83d58"
>NumberOfReportsSentToHandingOverRBC &gt; 0</PreCondition><PreCondition
 Guid="bb5277e0-aa5c-48e6-a9b9-1ef76c7ff93a"
>SecondRBCHandoverPositionReportTime + TimeBeforeMessageRepetition &lt; Kernel.CurrentTime</PreCondition><PreCondition
 Guid="aa7bc635-025b-4bfa-b27c-d05d3984511b"
>NumberOfSentReportRepetitions &lt; NumberOfMessageRepetitions</PreCondition></PreConditions>
<Actions>
<Action
 Guid="2dd104eb-cbba-403c-96ba-4318538874a7"
>SendSecondRBCHandoverPositionReport()</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="No order to terminate the session received from Handing Over RBC, max number of requests reached"
 Guid="c80e9ee2-5f20-450d-9965-70051084c67c"
>
<ReqRef
 Id="d8eba2a2-5b1e-4e5f-878d-ead661e95e50"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="26df6f09-a065-4d35-aabc-29337822f535"
>
</ReqRef><Comment>If no order to terminate the session is received from Handing Over RBC before the timeout and the meximum number of position reports has been sent =&gt; terminate the communication session.</Comment>
<PreConditions>
<PreCondition
 Guid="2351d843-a038-4af6-af2c-0388a7b3a7cb"
>NumberOfSentReportRepetitions == NumberOfMessageRepetitions</PreCondition><PreCondition
 Guid="22623cd7-98dd-4219-a3da-8d0a348c1178"
>NumberOfReportsSentToHandingOverRBC &gt; 0</PreCondition><PreCondition
 Guid="d30495ba-3762-4c19-96f3-456143f7ae70"
>SecondRBCHandoverPositionReportTime + TimeBeforeMessageRepetition &lt; Kernel.CurrentTime</PreCondition></PreConditions>
<Actions>
<Action
 Guid="17311951-1bd7-40ab-9779-aee39c8727f4"
>CurrentRBCConnection().ConnectionState &lt;- RBCStruct.ConnectionStateSM.Inactive</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</NameSpace>
