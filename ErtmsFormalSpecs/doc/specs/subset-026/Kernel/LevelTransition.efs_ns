<NameSpace
 X="160"
 Y="600"
 Width="100"
 Height="50"
 Hidden="TRUE"
 Pinned="TRUE"
 Name="LevelTransition"
 Guid="c7686458-322b-4861-9f8c-de43b74bb2c3"
>
<Comment></Comment>
<NameSpaces>
</NameSpaces>
<Structures>
<Structure
 Default=""
 X="450"
 Y="380"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="LevelTransition"
 Guid="d5dd0ecb-bbb2-49c8-a2cf-cfc1498e4d2d"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1c9c894e-b403-43e4-940a-a41a5304413a"
>
</ReqRef><ReqRef
 Id="8015eb3f-9570-4532-95e5-d755311dfa7a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5a26d0da-a356-45fe-a2f5-f7d176ec2d2c"
>
</ReqRef><ReqRef
 Id="375f3135-e004-4d28-9eff-dc2eb0a8bc7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ea4e2c95-0a5b-4441-b32c-26918ed088b7"
>
</ReqRef><StructureElement
 TypeName="Default.BaseTypes.Length"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="AcknLength"
 Guid="467478db-5a13-4b20-b6ba-fe14a259d387"
>
<ReqRef
 Id="8dc3adec-c4e6-489e-849a-d05eac8ee50b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="af193e56-1121-4498-a70f-d19d01f96aac"
>
</ReqRef></StructureElement><StructureElement
 TypeName="Default.LevelDataStruct"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="TRLevel"
 Guid="692b9f3c-cf6a-48c1-b629-b20539429dba"
>
<ReqRef
 Id="a59e0f85-7d70-426a-a85c-75592258286f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="853740c6-8e99-40d7-b4ea-c90875669cd4"
>
</ReqRef><ReqRef
 Id="957132d4-ee44-447a-8bae-75d858cd1963"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="166e5b58-4865-45e1-a493-cbdd0f15b840"
>
</ReqRef><Comment></Comment>
</StructureElement></Structure><Structure
 Default=""
 X="260"
 Y="290"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="LevelTransitionOrder"
 Guid="4941448b-3df6-4eae-8321-c4ea9331b27c"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5eb6aa01-aa99-4b49-83d1-4aa2e2fc7282"
>
</ReqRef><ReqRef
 Id="569b9466-f366-4f5e-b29a-47dbd42081e2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fde13829-81e7-4dd9-9af9-486e512cb8dc"
>
</ReqRef><ReqRef
 Id="375f3135-e004-4d28-9eff-dc2eb0a8bc7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1357aa53-9594-4df9-a14e-92c3936e1421"
>
</ReqRef><Comment></Comment>
<StructureElement
 TypeName="Default.BaseTypes.Distance"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Distance"
 Guid="4f40beb6-ff3b-4761-822e-d73684fc10ce"
>
<ReqRef
 Id="48cd2e35-67c2-46a5-9f39-4d543c9361d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="87188775-ccc8-46ae-ae6b-2a58661f4fa0"
>
</ReqRef></StructureElement><StructureElement
 TypeName="LTs"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="LevelAndLength"
 Guid="ac8bcb1e-a8c3-49a6-b543-1cdd6f9705b0"
>
<ReqRef
 Id="8dc3adec-c4e6-489e-849a-d05eac8ee50b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="93b3e829-47db-4fdf-aa99-a5d0304a65e1"
>
</ReqRef><Comment></Comment>
</StructureElement><StructureElement
 TypeName="Boolean"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="IsLTO"
 Guid="4eeaf3fb-5a46-4956-b0d8-11627181636a"
>
</StructureElement></Structure></Structures>
<Collections>
<Collection
 TypeName="LevelTransition"
 MaxSize="20"
 Default="[]"
 X="450"
 Y="290"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="LTs"
 Guid="515a3a9b-fcdb-4d4b-84fb-7d347a587cbf"
>
<ReqRef
 Id="375f3135-e004-4d28-9eff-dc2eb0a8bc7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1da9d143-d07f-490c-98a3-ed1e9d19f02e"
>
</ReqRef><Comment></Comment>
</Collection></Collections>
<Functions>
<Function
 Type="Default.Level"
 Default=""
 X="750"
 Y="120"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="ERTMS_to_EFS_Level"
 Guid="cd232b1d-a061-442b-bb87-7659f2506c34"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="deda796a-0385-4be7-90e2-3d0b343d6564"
>
</ReqRef><Comment></Comment>
<Parameters>
<Parameter
 Type="Messages.M_LEVELTR"
 Name="LevelT"
 Guid="2675e0a5-7baa-40c5-ab70-7640110a784c"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Level 0"
 Guid="5a1ecea0-9764-450c-8b31-874818732f14"
>
<PreConditions>
<PreCondition
 Guid="5afbaba3-f808-437d-b085-4139409c92ea"
>LevelT== Messages.M_LEVELTR.Level_0</PreCondition></PreConditions>
<Expression>Default.Level.L0</Expression>
</Case><Case
 Name="Level 1"
 Guid="6bc3f312-88af-4e25-9d3e-e6d2b04fb7de"
>
<PreConditions>
<PreCondition
 Guid="c4adefb8-5403-4459-ae07-a08a5abb77c8"
>LevelT == Messages.M_LEVELTR.Level_1</PreCondition></PreConditions>
<Expression>Default.Level.L1</Expression>
</Case><Case
 Name="Level 2"
 Guid="87b3fa69-db82-427d-b7c5-8628085f1117"
>
<PreConditions>
<PreCondition
 Guid="77a55ed0-fc74-4fb8-9db2-444105a39fab"
>LevelT == Messages.M_LEVELTR.Level_2</PreCondition></PreConditions>
<Expression>Default.Level.L2</Expression>
</Case><Case
 Name="Level 3"
 Guid="2bd9216e-6801-402b-a88c-ef6ee9dfcdcd"
>
<PreConditions>
<PreCondition
 Guid="53c00526-b28d-44d6-a8f8-8960a6b415f2"
>LevelT == Messages.M_LEVELTR.Level_3</PreCondition></PreConditions>
<Expression>Default.Level.L3</Expression>
</Case><Case
 Name="Level STM"
 Guid="204562b3-8736-4ca6-9d1e-3054cb410f83"
>
<PreConditions>
<PreCondition
 Guid="416ab9e7-316b-4221-b5c5-666f38de4161"
>LevelT == Messages.M_LEVELTR.Level_STM_specified_by_NID_STM</PreCondition></PreConditions>
<Expression>Default.Level.LNTC</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="750"
 Y="60"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="AvailableForUse"
 Guid="53cf121e-1419-433c-a39b-5d3a6ac9e7f4"
>
<ReqRef
 Id="d88669ab-b014-4a92-b565-0f1e46f40945"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="17388681-ae49-4d52-b851-2c7f6320e914"
>
</ReqRef><Comment>Level NTC remains a non-implemented case because we have no information here which NTC/STM is relevant (and how this is modelled).</Comment>
<Parameters>
<Parameter
 Type="Default.LevelDataStruct"
 Name="Level"
 Guid="46695204-7578-4c8a-9699-e0c5e4ed1123"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Level 0,1"
 Guid="4b1df126-54b3-4c89-875e-211b858d1952"
>
<PreConditions>
<PreCondition
 Guid="47dafefb-e91a-4ce8-9bb9-714efb34ba20"
>Level.Value in [Default.Level.L0, Default.Level.L1]</PreCondition></PreConditions>
<Expression>Boolean.True</Expression>
</Case><Case
 Name="Level NTC"
 Guid="199eb7de-5afe-4668-864b-7286008e167a"
>
<PreConditions>
<PreCondition
 Guid="3894d9bf-99c3-4031-a849-43c8d27dfba7"
>Level.Value == Default.Level.LNTC</PreCondition><PreCondition
 Guid="d4921d5d-80a6-4357-9508-d1e02eee12f6"
>THERE_IS_IN Kernel.TrainData.TrainData.Value.LevelsSupportedOnBoard |  ( X.Value == Level.Value AND X.NTC == Level.NTC )</PreCondition></PreConditions>
<Expression>Boolean.True</Expression>
</Case><Case
 Name="Level 2,3"
 Guid="6358c398-bfa0-4889-9fea-c1774ec93f6a"
>
<PreConditions>
<PreCondition
 Guid="c2264a6b-4910-4c79-bc1f-45ac870f5e5a"
>Level.Value in [Default.Level.L2, Default.Level.L3]</PreCondition><PreCondition
 Guid="61d995ef-8596-4728-b62d-8eca9127d8d8"
>EURORADIO.OneMobileTerminalIsAvailable()</PreCondition></PreConditions>
<Expression>Boolean.True</Expression>
</Case><Case
 Name="Otherwise"
 Guid="aafdca18-228e-4281-a30d-e1799a998e52"
>
<Expression>Boolean.False</Expression>
</Case></Cases>
</Function></Functions>
<Procedures>
<Procedure
 X="40"
 Y="60"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="AddNewLTO"
 Guid="17b81d46-93b1-4f1e-acad-9a5a64af63cf"
>
<ReqRef
 Id="8dc3adec-c4e6-489e-849a-d05eac8ee50b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f8927730-587d-4ac4-8f10-dcdc956c64c2"
>
</ReqRef><ReqRef
 Id="a59e0f85-7d70-426a-a85c-75592258286f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c68f0959-ee13-4990-9346-4315b8bac50f"
>
</ReqRef><ReqRef
 Id="8015eb3f-9570-4532-95e5-d755311dfa7a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="af8f9d60-81f0-4f41-9351-68d72b8a37bd"
>
</ReqRef><ReqRef
 Id="375f3135-e004-4d28-9eff-dc2eb0a8bc7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0d3127fc-63a8-4e10-b3d5-a05d1aa4e528"
>
</ReqRef><Parameters>
<Parameter
 Type="Default.MessageTypes.Length"
 Name="L_ACKLEVELTR"
 Guid="61d38eaa-05d3-4cae-8d6c-318c10a31f9c"
>
</Parameter><Parameter
 Type="Messages.M_LEVELTR"
 Name="M_LEVELTR"
 Guid="7376ff28-7b7d-44ea-ae56-06cd470b3e09"
>
</Parameter><Parameter
 Type="Messages.Q_SCALE"
 Name="Q_SCALE"
 Guid="781237a3-2c52-40c8-b52b-fbc9efb59607"
>
</Parameter><Parameter
 Type="Messages.NID_NTC"
 Name="NID_NTC"
 Guid="c7045001-1398-4d36-9778-9b179f4265d2"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="AddNewLTO"
 Guid="3cef57c0-1b62-417d-9593-f4ea8e6ab7e6"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="NewLevelTransitionToNTC"
 Guid="73dab62e-9c45-4ec1-8529-6f89f30f4815"
>
<PreConditions>
<PreCondition
 Guid="deffbc9b-7242-4693-960f-aef5e0d2a07c"
>ERTMS_to_EFS_Level ( LevelT =&gt; M_LEVELTR ) == Default.Level.LNTC</PreCondition></PreConditions>
<Actions>
<Action
 Guid="5a5d8ed3-4dc4-4a07-8e01-dca8be3b0fed"
>INSERT
LevelTransition
{
    AcknLength=&gt;MessageTypes.QScaleLength ( length =&gt; L_ACKLEVELTR, scale =&gt; Q_SCALE ),
    TRLevel =&gt; Default.LevelDataStruct {
       Value =&gt; ERTMS_to_EFS_Level ( LevelT =&gt; M_LEVELTR ),
       NTC =&gt; Default.NID_NTC(NID_NTC)
    }
}
IN  LevelTransitionOrder.LevelAndLength</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="NewLevelTransition"
 Guid="bc06ebae-82a4-47c1-ba19-ba8f8e948492"
>
<PreConditions>
<PreCondition
 Guid="5f3b6b13-fbbb-49f3-9e3c-593ace6052e8"
>ERTMS_to_EFS_Level ( LevelT =&gt; M_LEVELTR ) != Default.Level.LNTC</PreCondition></PreConditions>
<Actions>
<Action
 Guid="3896ef04-bbce-4b8e-bc64-36982d960e64"
>INSERT
LevelTransition
{
    AcknLength=&gt;MessageTypes.QScaleLength ( length =&gt; L_ACKLEVELTR, scale =&gt; Q_SCALE ),
    TRLevel =&gt; Default.LevelDataStruct {
       Value =&gt; ERTMS_to_EFS_Level ( LevelT =&gt; M_LEVELTR ),
       NTC =&gt; Default.NID_NTC.NOT_APPLICABLE
    }
}
IN  LevelTransitionOrder.LevelAndLength</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="40"
 Y="120"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="LTOReceived"
 Guid="304f3b87-4b8b-42a3-8c9b-56d23ffbd040"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5f527624-66fc-4329-ba25-e1abe05be5eb"
>
</ReqRef><ReqRef
 Id="8015eb3f-9570-4532-95e5-d755311dfa7a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="05acd2a5-8f46-436c-9a1a-5cbe371fef62"
>
<Comment></Comment>
</ReqRef><ReqRef
 Id="b14e5210-48d3-4eed-89e3-4d03324dd8f6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="46f7a264-2f51-4d1a-b263-f2757761cb99"
>
</ReqRef><ReqRef
 Id="375f3135-e004-4d28-9eff-dc2eb0a8bc7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1b4a87b9-669b-41f3-977e-b2be0781dbc8"
>
</ReqRef><Comment>Is called whenever a new trackside-information regarding an upcoming transition is received. It will take care about the first (highest priority) LTO and forward the others to AddNewLTO.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.LEVEL_TRANSITION_ORDER.Message"
 Name="Packet"
 Guid="44953883-e910-4506-ae5f-d113f72e9bf9"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="ReceiveData_Part1"
 Guid="431257d3-ce85-4629-9e3d-44b0d3ff6a4f"
>
<ReqRef
 Id="154fb773-8860-4dc7-85c1-7aff2b6bd741"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b8643463-aeb5-4d39-bf81-5841894c6b47"
>
</ReqRef><ReqRef
 Id="375f3135-e004-4d28-9eff-dc2eb0a8bc7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fd280359-f58e-4ac5-8103-a1b976c43682"
>
</ReqRef><SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="NewLevelTransition"
 Guid="80f02659-3e0a-4140-9113-61a38c5b8fcf"
>
<Comment></Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="fdddee24-a2ec-4f7a-be60-6dc368978033"
>LevelTransitionOrder &lt;- LevelTransitionOrder
{
  IsLTO=&gt; True,
  Distance =&gt; MessageTypes.QScaleDistance ( distance =&gt; Packet.D_LEVELTR, scale =&gt; Packet.Q_SCALE ),
  LevelAndLength =&gt; 
  [ 
      LevelTransition { 
          AcknLength =&gt; MessageTypes.QScaleLength( length=&gt;Packet.L_ACKLEVELTR,  scale=&gt;Packet.Q_SCALE ),
          TRLevel =&gt; Default.LevelDataStruct {
             Value =&gt; ERTMS_to_EFS_Level ( Packet.M_LEVELTR ) ,
             NTC =&gt; Packet.NID_NTC
         }
      }
  ]
}</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="ReceiveData_Part2"
 Guid="019f945e-875d-4a18-a861-769eb9da18ac"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="NextLevelTransition"
 Guid="7915a4ef-dfb9-4e29-998c-3d273019ad3e"
>
<Comment></Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="a8e25caf-0ad5-4053-ac0a-f626072bf07e"
>APPLY 
AddNewLTO 
( 
   L_ACKLEVELTR =&gt; X.L_ACKLEVELTR,
   M_LEVELTR =&gt; X.M_LEVELTR,
   NID_NTC =&gt; Packet.NID_NTC,
   Q_SCALE=&gt; Packet.Q_SCALE
)
ON 
Packet.Sequence1</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="ProcessLTO"
 Guid="9c568db2-28f9-4b44-a8a4-d25f61ec89c2"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="ProcessLTO"
 Guid="bbe927d4-96e9-44f8-988b-0bf8b08a27e4"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="f47d50dc-9fb7-45f3-bad6-736e4f447e1e"
>ProcessLTOGeneric()</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="150"
 Y="60"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="CLTOReceived"
 Guid="592255a0-2935-48b2-b02c-da2ba5d0b49b"
>
<ReqRef
 Id="569b9466-f366-4f5e-b29a-47dbd42081e2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="338336d3-0344-4b2f-8380-68db927b7096"
>
</ReqRef><Comment></Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.CONDITIONAL_LEVEL_TRANSITION_ORDER.Message"
 Name="Packet"
 Guid="3c51134e-97a7-4127-9cdb-e4e12b740aa8"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Name="ReceiveData_Part1"
 Guid="71e17414-df0a-4b73-b728-0440539665b4"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="NewConditionalLevelTransition"
 Guid="5414400b-af6a-4136-828a-e6ebe9b04a47"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="747eb726-b54e-45cc-ab5b-9093722e93e4"
>LevelTransitionOrder &lt;- LevelTransitionOrder
{
   IsLTO=&gt; False,
   Distance =&gt; EMPTY,
   LevelAndLength =&gt; [ 
      LevelTransition { 
         AcknLength =&gt;EMPTY, 
         TRLevel =&gt; Default.LevelDataStruct {
             Value =&gt; ERTMS_to_EFS_Level( LevelT =&gt;Packet.M_LEVELTR ),
             NTC =&gt; Packet.NID_NTC
         }
      }
   ]
}</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="ReceiveData_Part2"
 Guid="8f83c7d2-f581-49d3-964f-0a37295c2979"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="NextConditionalLevelTransition"
 Guid="6c77b971-d614-4463-909a-3b5aa347c13f"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="57e67d49-4efd-4083-a2c5-a7a599eaf591"
>APPLY 
AddNewLTO 
(  
   M_LEVELTR =&gt; X.M_LEVELTR,
   NID_NTC =&gt; Packet.NID_NTC,
   Q_SCALE =&gt; EMPTY,
   L_ACKLEVELTR =&gt; EMPTY 
)
ON 
Packet.Sequence1</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="CurrentLevelNotInList"
 Guid="b0986f57-114d-4425-ba4c-9f93221238e2"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="CurrentLevelNotInList"
 Guid="04b0ea50-4702-4e8b-a61a-8ab209c27006"
>
<ReqRef
 Id="d8cf2f6a-d8be-41d9-948a-ae97df851041"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="28e41018-55ca-40cf-bb57-9116da7c76b1"
>
</ReqRef><ReqRef
 Id="e959ba39-6b20-4678-ab9e-59be9ce585a3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a7af2c92-6d39-405d-bdd0-ec901bb13ca4"
>
</ReqRef><ReqRef
 Id="dcd5e982-e0cd-4f3e-be0c-2d1ab066cfa7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9b7dca80-a5c3-4b54-a6e9-5fcfed3d100e"
>
</ReqRef><Comment>If this precondition is met, dont carry out a level transition #morido, 13/10/15</Comment>
<PreConditions>
<PreCondition
 Guid="7432ff75-4a66-4ae6-9aae-3df6be9e372b"
>NOT (THERE_IS_IN LevelTransitionOrder.LevelAndLength | X.TRLevel.Value == Kernel.Level.Value)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="1a6bdf17-071d-4c6b-921d-d6e6833e5395"
>ProcessLTOGeneric()</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="150"
 Y="120"
 Width="100"
 Height="50"
 Pinned="TRUE"
 NeedsRequirement="FALSE"
 Name="ProcessLTOSpecific"
 Guid="20ba453f-bef9-40d7-82e1-57155f75b2b6"
>
<ReqRef
 Id="76f0efaa-cd9d-4928-933c-029497eac8ea"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="df1a99d5-2b2b-4531-8926-487e170e3094"
>
</ReqRef><Comment>Wrapper to call the individual procedures in order to execute specific level transitions #morido, 13/10/15</Comment>
<Rules>
<Rule
 Priority="Processing"
 NeedsRequirement="FALSE"
 Name="L0ToL1"
 Guid="d135165a-61c3-4520-8066-1c0ea6c9386a"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 NeedsRequirement="FALSE"
 Name="L0ToL1"
 Guid="1f2089aa-d7d7-4ffd-850d-34e32b627b29"
>
<ReqRef
 Id="a568a86a-ecc1-4a37-9e71-fe905d72be9b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="780e33c0-570f-4548-bc08-1a2c642ebaa5"
>
</ReqRef><Comment>The handling of the other preconditions as required by 5.10.3.4.1 is done by Kernel.ModeTransitions.Condition39, #morido, 13/10/17</Comment>
<PreConditions>
<PreCondition
 Guid="bd1a1f4f-348c-43d7-a708-6fbb5d523280"
>Kernel.Level.Value == Default.Level.L0</PreCondition><PreCondition
 Guid="691dd9ff-515f-4c67-a0d5-1cf2ea537d1c"
>LTOtoProcess.TRLevel.Value == Default.Level.L1</PreCondition></PreConditions>
<Actions>
<Action
 Guid="04cbcfde-a8bc-4ce4-af15-db2cd46487b5"
>Kernel.Level.Value &lt;- Default.Level.L1</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="260"
 Y="60"
 Width="100"
 Height="50"
 Pinned="TRUE"
 NeedsRequirement="FALSE"
 Name="ProcessLTOGeneric"
 Guid="9f0e907e-219e-4923-a617-2a61a1063133"
>
<ReqRef
 Id="5000ea5a-8c25-4e82-b64e-1651fe1cea12"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="45363af2-0936-412e-9368-b4ef2b8c06c1"
>
</ReqRef><Comment>This does all general stuff required for a level transition independent from the source and target level It is therefore a preliminary step for ProcessLTOSpecific. #morido, 13/10/15</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="ReduceLTOtoOne"
 Guid="82a28339-5519-4d4f-8f48-fb0925f0bf48"
>
<ReqRef
 Id="a7b92d29-b0ce-4de8-8642-497eddf906d4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="52896317-fa43-4b20-bf88-201b8512a6d3"
>
</ReqRef><ReqRef
 Id="19d133b1-bf49-4450-93e0-905a1a42b1e7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fbb1473a-f0aa-4110-908c-b391112b8736"
>
<Comment></Comment>
</ReqRef><Comment>We now prepare the level-transition. I.e. all relevant data has been received and we will now filter out the one single transition which shall be performed</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="ReduceLTOtoOne"
 Guid="f4557bca-d63c-4099-88fe-7af1e08de1c5"
>
<Comment></Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="ed925502-1144-4258-9df9-8077986730c3"
>LTOtoProcess &lt;- FIRST_IN LevelTransitionOrder.LevelAndLength | AvailableForUse( Level=&gt; X.TRLevel )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="FallbackIfNothingAvailable"
 Guid="6e7e131b-05be-48da-8d86-4f3cd1e5fd9a"
>
<ReqRef
 Id="eba5be0d-c9b6-41cf-8df3-0cf45aa32159"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2a66ddbd-1775-4be9-872c-7381d0d40473"
>
<Comment></Comment>
</ReqRef><Comment>This is only executed if the previous step (&quot;ReduceLTOtoOne&quot;) failed (i,e, nothing is available)</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="FallbackIfNothingAvailable"
 Guid="ab6c5d8f-4fea-4400-b8c1-34b13a2785bf"
>
<Comment></Comment>
<PreConditions>
<PreCondition
 Guid="aea1dfa9-f22d-41e6-b71f-28c16a37d8ab"
>LTOtoProcess.AcknLength == Default.BaseTypes.Length.NA</PreCondition><PreCondition
 Guid="0905157e-7ec2-4c8f-b7ed-41eda4a774b2"
>LTOtoProcess.TRLevel.Value == Default.Level.Unknown</PreCondition><PreCondition
 Guid="51f56750-a2ca-4d8d-813b-c8da29fbd2e3"
>LTOtoProcess.TRLevel.NTC == Default.NID_NTC.NOT_APPLICABLE</PreCondition></PreConditions>
<Actions>
<Action
 Guid="13a35181-3fe7-41a0-ac21-38a64a3091f6"
>LTOtoProcess &lt;- LAST_IN ( LevelTransitionOrder.LevelAndLength )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="InformDriver"
 Guid="898f996b-69b4-4d52-ae1f-3dd5bfa05238"
>
<ReqRef
 Id="91f853db-5446-42e9-bd20-c7df2c617fdd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6988d1f9-f232-4f42-9d62-6452b2d50767"
>
</ReqRef><ReqRef
 Id="54debebc-e391-4fd2-a3d7-8e0abf2a1c27"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="168bf46d-fb43-4d00-b2df-67169b6ca76c"
>
</ReqRef><ReqRef
 Id="a0fffb6f-52dd-4294-b705-ac27dc95a180"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9eb81320-eade-44b5-b9b0-46d61d2f7258"
>
</ReqRef><Comment></Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="InformDriver"
 Guid="2cf55614-4bd8-418a-b952-e32bea75338f"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="fd368ae9-0601-449f-b2c9-e3ef3f7370e8"
>DMI.MasterDMI().DisplayLevelTransitionAnnouncement(LTOtoProcess.TRLevel.Value)</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 NeedsRequirement="FALSE"
 Name="ExecuteActualTransition"
 Guid="b1028b7b-0bfc-49d2-8eb1-e2e40d9f5e12"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 NeedsRequirement="FALSE"
 Name="ExecuteActualTransition"
 Guid="375ba55f-1455-4531-b8e0-b6687a05bfb1"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="8f2c7bc2-6559-4bb8-ab99-9de3a0b6c6d6"
>ProcessLTOSpecific()</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<Variables>
<Variable
 Type="LevelTransitionOrder"
 DefaultValue="EMPTY"
 VariableMode="Internal"
 X="50"
 Y="290"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="LevelTransitionOrder"
 Guid="1090a9f6-edf2-4b09-8c7a-3bd882af71eb"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="37a8549c-70e7-40db-81f0-196e5f56600a"
>
<Comment></Comment>
</ReqRef><ReqRef
 Id="6b26f38c-d98d-4eee-a314-ae6b48256d36"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c27ec864-3c14-4011-b217-ea54c96e8b00"
>
</ReqRef><ReqRef
 Id="51ddbc44-360a-4339-9b7c-fc91347a5da2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c2abeb43-c104-4ec4-9329-c03b18b69ce6"
>
</ReqRef><Comment>Level transition order  received from the track side</Comment>
</Variable><Variable
 Type="Kernel.LevelTransition.LevelTransition"
 DefaultValue=""
 VariableMode="Internal"
 X="260"
 Y="380"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="LTOtoProcess"
 Guid="c4da5415-191f-483c-880e-1c2e86e52dea"
>
<ReqRef
 Id="a7b92d29-b0ce-4de8-8642-497eddf906d4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3d81a9fc-56e0-4b4b-87a3-1cd11c8bfa42"
>
</ReqRef><Comment>The (target-)level (and -distance) that the train should perform a transition to (i.e. the output of the computations)</Comment>
</Variable></Variables>
<Rules>
<Rule
 Priority="Processing"
 X="490"
 Y="60"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="ExecuteLevelTransitionOrder"
 Guid="2d1413d6-1677-4d3a-9fd6-3e25c3ab814f"
>
<ReqRef
 Id="d20e6c3b-b738-4e4a-9046-a9bc93ed6bf1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5479e312-51ed-4bcd-84c0-79c01422495c"
>
<Comment></Comment>
</ReqRef><ReqRef
 Id="569b9466-f366-4f5e-b29a-47dbd42081e2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d9242104-b92f-4824-9f1e-e35e3bb21582"
>
</ReqRef><Comment></Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="ExecuteLevelTransitionOrder"
 Guid="ac07ff8b-fc42-4327-a7ab-f1d27cc45a2b"
>
<Comment>NTC-part not functional for now (Kernel.NationalSystemId). Requirement for this is missing. Is it needed? #morido, 13/10/14</Comment>
<PreConditions>
<PreCondition
 Guid="32291f91-c8f4-4551-9efb-1784c4b3c42b"
>LevelTransitionOrder.Distance == BTM.TravelledDistanceFromLRBG()</PreCondition><PreCondition
 Guid="8a9cadaf-670b-4f32-8b9e-4b84655afe7a"
>LevelTransitionOrder.IsLTO== True</PreCondition></PreConditions>
<Actions>
<Action
 Guid="097a357d-a5c2-47af-a6ac-050fe94ed1ed"
>Kernel.Level.Value &lt;- LTOtoProcess.TRLevel.Value</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</NameSpace>
